<!DOCTYPE html>
    <html>
        <head>
            <title>报表</title>
            <meta charset="utf-8" />
            <style>
                body{
                    font-size:24px;
                }
                div[id^=pageHeader] h3{
                    font-size:28px;
                    clear:both;
                }
                ul{
                    margin-left:60px;
                    margin-top:70px;
                    margin-bottom:30px;
                }
                .page{
                    position: relative;
                    display: block;
                    page-break-after: auto;
                    margin: 50px;
                    overflow: hidden;
                }
                @media print{
                    body{
                        //background: black;
                    }
                    .page{
                        margin: 0;
                        height: 100%;
                        width: 100%;
                    }
                }
                .logo{
                    color:#666666;
                    font-size:22px;
                    float:right;
                    position:absolute;
                    right:50px;
                    top:10px;
                }
                .page table{
                    border:1px solid #333333;
                    text-align:center;
                    width:86%;
                    margin:0 auto;
                    border-collapse:collapse;
                    border-spacing:0;
                }
                .page table td,
                .page table th{
                    padding:5px;
                    font-size:14px;
                    text-align:center;
                    border-right:1px dotted #AAAAAA;
                    border-bottom:1px dotted #AAAAAA;
                }
                .page table.small td,
                .page table.small th{
                    padding:0px;
                    font-size:12px;
                }
                .page table tr.title{
                    background:#FCE6A3;
                }
                .page table tr.total{
                    color:red;
                    font-weight:bold;
                }
            </style>
        </head>

        <%
            var ecRpt = {
                subway: {
                    items: [],
                    keywords: []
                },
                zuanshi: {
                    campaigns: [],
                    targets: []
                }
            };
            var fcRpt = {
                subway: {
                    items: [],
                    keywords: []
                },
                zuanshi: {
                    campaigns: [],
                    targets: []
                }
            };
            var pcRpt = {
                subway: {
                    items: [],
                    keywords: []
                },
                zuanshi: {
                    campaigns: [],
                    targets: []
                }
            };
            var products = {
                ec: new RegExp('HP01|HP02|AM11|AM10|AM06|AM07|AM08|TP02|DP01|AM09', 'i'),
                fc: new RegExp('DC26|DC36|DC48|DC52|V6TopDog|V6Car|V6Motorhead|V6Absolute|V8Absolute|V8Fluffy|V6Fluffy|V6Fluffy＋|V6Origin|CY22|V6Mattress|DC45', 'i'),
                pc: new RegExp('HD01', 'i'), 
            };
            var subwayItemIncludeKeywords = {
                '净化': new RegExp('AM11|HP01|HP02', 'i'),
                '风扇': new RegExp('AM06|AM07|AM08|TP02|DP01', 'i'),
                '取暖器': new RegExp('AM09', 'i'), 
                '加湿器': new RegExp('AM10', 'i'),
                '吸尘器': new RegExp('V6TopDog|V6Car|V6Motorhead|V6Origin|V6Fluffy|V6Fluffy＋|V6Absolute|V8Absolute|V8Fluffy|DC45', 'i'),
                '车载吸尘器': new RegExp('V6Car'),
                '圆筒吸尘器': new RegExp('CY22|DC26|DC36|DC48|DC52', 'i'),
                '除螨仪': new RegExp('V6Mattress', 'i'),
                '吹风机': new RegExp('HD01', 'i')
            };
            var zuanshiCampaignIncludeKeywords = ['吸尘器', '除螨', '车载', '吹风机', '净化', '全'];
            var subwayItemIncludeKeywordReports = {};
            var zuanshiCampaignIncludeKeywordReports = {};
                    
            var subwayItemReports = reports.subwayItemReports;
            subwayItemReports = subwayItemReports.split("\n");
            subwayItemReports.shift();
            for (var i in subwayItemReports) {
                if (subwayItemReports[i]) {
                    subwayItemReports[i] = subwayItemReports[i].split(',');
                    if (subwayItemReports[i][1].indexOf('皇冠车手') > -1 || subwayItemReports[i][1].indexOf('阻击计划') > -1 || subwayItemReports[i][2].indexOf('干手器') > -1 || subwayItemReports[i][2].indexOf('配件') > -1) {
                        delete subwayItemReports[i];
                    } else {
                        for (var j in subwayItemIncludeKeywords) {      
                            if ( ! subwayItemIncludeKeywordReports[j]) {
                                subwayItemIncludeKeywordReports[j] = []; 
                            }
                            
                            if (subwayItemIncludeKeywords[j].test(subwayItemReports[i][2].replace(/\s/ig, ''))) {
                                if (j === '吸尘器' && (subwayItemReports[i][2].replace(/\s/ig, '').indexOf('车载吸尘器') > -1 || subwayItemReports[i][2].replace(/\s/ig, '').indexOf('圆筒吸尘器') > -1)) {
                                    continue;
                                }
                                subwayItemIncludeKeywordReports[j].push(subwayItemReports[i]);
                            }
                        }

                        if (products.ec.test(subwayItemReports[i][2].replace(/\s/ig, ''))) {
                            ecRpt.subway.items.push(subwayItemReports[i]);
                        } else if (products.fc.test(subwayItemReports[i][2].replace(/\s/ig, ''))) {
                            fcRpt.subway.items.push(subwayItemReports[i]);
                        } else if (products.pc.test(subwayItemReports[i][2].replace(/\s/ig, ''))) {
                            pcRpt.subway.items.push(subwayItemReports[i]);
                        }
                    }
                } else {
                    delete subwayItemReports[i];
                }
            }

            var subwayKeywordReports = reports.subwayKeywordReports;
            subwayKeywordReports = subwayKeywordReports.split("\n");
            subwayKeywordReports.shift();
            for (var i in subwayKeywordReports) {
                if (subwayKeywordReports[i]) {
                    subwayKeywordReports[i] = subwayKeywordReports[i].split(',');
                    if (subwayKeywordReports[i][1].indexOf('皇冠车手') > -1  || subwayKeywordReports[i][1].indexOf('阻击计划') > -1 || subwayKeywordReports[i][2].indexOf('干手器') > -1 || subwayKeywordReports[i][2].indexOf('配件') > -1) {
                        delete subwayKeywordReports[i];
                    } else {
                        if (products.ec.test(subwayKeywordReports[i][2].replace(/\s/ig, ''))) {
                            ecRpt.subway.keywords.push(subwayKeywordReports[i]);
                        } else if (products.fc.test(subwayKeywordReports[i][2].replace(/\s/ig, ''))) {
                            fcRpt.subway.keywords.push(subwayKeywordReports[i]);
                        } else if (products.pc.test(subwayKeywordReports[i][2].replace(/\s/ig, ''))) {
                            pcRpt.subway.keywords.push(subwayKeywordReports[i]);
                        }
                    }
                } else {
                    delete subwayKeywordReports[i];
                }
            }

            var zuanshiCampaignReports = reports.zuanshiCampaignReports;
            for (var i in zuanshiCampaignReports) {
                for (var j in zuanshiCampaignIncludeKeywords) {
                    if ( ! zuanshiCampaignIncludeKeywordReports[zuanshiCampaignIncludeKeywords[j]] && zuanshiCampaignIncludeKeywords[j] !== '全') {
                        zuanshiCampaignIncludeKeywordReports[zuanshiCampaignIncludeKeywords[j]] = [];
                    }
                    if (zuanshiCampaignReports[i].campaignName.indexOf(zuanshiCampaignIncludeKeywords[j]) > -1) {
                        if (zuanshiCampaignIncludeKeywords[j] === '全') {
                            if ( ! zuanshiCampaignIncludeKeywordReports['吸尘器']) {
                                zuanshiCampaignIncludeKeywordReports['吸尘器'] = [];
                            }
                            zuanshiCampaignIncludeKeywordReports['吸尘器'].push(zuanshiCampaignReports[i]);
                        } else if (zuanshiCampaignIncludeKeywords[j] === '吸尘器') {
                            if (zuanshiCampaignReports[i].campaignName.indexOf('圆筒') > -1) {
                                if ( ! zuanshiCampaignIncludeKeywordReports['圆筒']) {
                                    zuanshiCampaignIncludeKeywordReports['圆筒'] = [];
                                }
                                zuanshiCampaignIncludeKeywordReports['圆筒'].push(zuanshiCampaignReports[i]);
                            } else if (zuanshiCampaignReports[i].campaignName.indexOf('车载') === -1) {
                                if ( ! zuanshiCampaignIncludeKeywordReports['吸尘器']) {
                                    zuanshiCampaignIncludeKeywordReports['吸尘器'] = [];
                                }
                                zuanshiCampaignIncludeKeywordReports['吸尘器'].push(zuanshiCampaignReports[i]);
                            }
                        } else if (zuanshiCampaignIncludeKeywords[j] === '净化') {
                            if (zuanshiCampaignReports[i].campaignName.indexOf('北') > -1 || zuanshiCampaignReports[i].campaignName.indexOf('活') > -1) {
                                zuanshiCampaignIncludeKeywordReports['净化'].push(zuanshiCampaignReports[i]);
                            } else {
                                if ( ! zuanshiCampaignIncludeKeywordReports['取暖']) {
                                    zuanshiCampaignIncludeKeywordReports['取暖'] = [];
                                }
                                zuanshiCampaignIncludeKeywordReports['取暖'].push(zuanshiCampaignReports[i]);
                            }
                        } else {
                            zuanshiCampaignIncludeKeywordReports[zuanshiCampaignIncludeKeywords[j]].push(zuanshiCampaignReports[i]);
                        }
                    }
                }
                if (zuanshiCampaignReports[i].campaignName.toLowerCase().indexOf('ec') > -1) {
                    ecRpt.zuanshi.campaigns.push(zuanshiCampaignReports[i]);
                } else if (zuanshiCampaignReports[i].campaignName.toLowerCase().indexOf('fc') > -1 || zuanshiCampaignReports[i].campaignName.toLowerCase().indexOf('全') > -1) {
                    fcRpt.zuanshi.campaigns.push(zuanshiCampaignReports[i]);
                } else if (zuanshiCampaignReports[i].campaignName.toLowerCase().indexOf('吹风机') > -1) {
                    pcRpt.zuanshi.campaigns.push(zuanshiCampaignReports[i]);
                }
            }

            var zuanshiTargetReports = reports.zuanshiTargetReports;
            for (var i in zuanshiTargetReports) {
                if (zuanshiTargetReports[i].campaignName.toLowerCase().indexOf('ec') > -1) {
                    ecRpt.zuanshi.targets.push(zuanshiTargetReports[i]);
                } else if (zuanshiTargetReports[i].campaignName.toLowerCase().indexOf('fc') > -1 || zuanshiTargetReports[i].campaignName.toLowerCase().indexOf('全') > -1) {
                    fcRpt.zuanshi.targets.push(zuanshiTargetReports[i]);
                } else if (zuanshiTargetReports[i].campaignName.toLowerCase().indexOf('吹风机') > -1) {
                    pcRpt.zuanshi.targets.push(zuanshiTargetReports[i]);
                }
            }
        %>

        <body>
            <div class="page">
                <div id="pageHeader-1">
                    <span class="logo">Dyson</span>
                </div>
                <h1>周报</h1>
            </div>

            <div class="page">
                <%
                    var p1TotalPv       = parseInt(reports.subwayShopReports.impression) + parseInt(reports.zuanshiShopReports.adPv);
                    var p1TotalClick    = parseInt(reports.subwayShopReports.click) + parseInt(reports.zuanshiShopReports.click);
                    var p1TotalOrder    = parseInt(reports.subwayShopReports.transactionshippingtotal) + parseInt(reports.zuanshiShopReports.alipayInShopNum);
                    var p1TotalCost     = parseFloat(reports.subwayShopReports.cost / 100) + parseFloat(reports.zuanshiShopReports.charge);
                    var p1TotalAmt      = parseFloat(reports.subwayShopReports.transactiontotal / 100) + parseFloat(reports.zuanshiShopReports.alipayInshopAmt);
                    var p1TotalCart     = parseInt(reports.subwayShopReports.carttotal) + parseInt(reports.zuanshiShopReports.cartNum);
                    var p1TotalFavItem  = parseInt(reports.subwayShopReports.favitemtotal) + parseInt(reports.zuanshiShopReports.inshopItemColNum);
                %>
                <div id="pageHeader-2">
                    <h3>Weekly Review 天猫账户整体表现</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key Findings：xxxxxx。</li>
                </ul>
                <table>
                    <tr class="title">
                        <th>平台</th>
                        <th>Impression</th>
                        <th>Click</th>
                        <th>CTR</th>
                        <th>Spend</th>
                        <th>CPC</th>
                        <th>Order</th>
                        <th>Sale</th>
                        <th>Cart</th>
                        <th>Fav</th>
                        <th>ROI</th>
                        <th>CVR</th>
                        <th>CPU</th>
                    </tr>
                    <tr>
                        <td>直通车</td>
                        <td><span class="number"><%= reports.subwayShopReports.impression %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.click %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.impression > 0 ? reports.subwayShopReports.click / reports.subwayShopReports.impression * 100 : 0 %></span>%</td>
                        <td><span class="number"><%= reports.subwayShopReports.cost / 100 %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.cpc / 100 %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.transactionshippingtotal %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.transactiontotal / 100 %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.carttotal %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.favitemtotal %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.roi %></span></td>
                        <td><span class="number"><%= reports.subwayShopReports.coverage %></span>%</td>
                        <td><span class="number"><%= reports.subwayShopReports.transactionshippingtotal > 0 ? Math.round(reports.subwayShopReports.cost / 100 / reports.subwayShopReports.transactionshippingtotal) : 0 %></span></td>
                    </tr>
                    <tr>
                        <td>钻展</td>
                        <td><span class="number"><%= reports.zuanshiShopReports.adPv %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.click %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.adPv > 0 ? reports.zuanshiShopReports.click / reports.zuanshiShopReports.adPv * 100 : 0 %></span>%</td>
                        <td><span class="number"><%= reports.zuanshiShopReports.charge %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.ecpc %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.alipayInShopNum %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.alipayInshopAmt %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.cartNum %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.inshopItemColNum %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.roi %></span></td>
                        <td><span class="number"><%= reports.zuanshiShopReports.click > 0 ? (reports.zuanshiShopReports.alipayInShopNum / reports.zuanshiShopReports.click) * 100 : 0 %></span>%</td>
                        <td><span class="number"><%= reports.zuanshiShopReports.alipayInShopNum > 0 ? Math.round(reports.zuanshiShopReports.charge / reports.zuanshiShopReports.alipayInShopNum) : 0 %></span></td>
                    </tr>
                    <tr class="total">
                        <td>总计</td>
                        <td><span class="number"><%= p1TotalPv %></span></td>
                        <td><span class="number"><%= p1TotalClick %></span></td>
                        <td><span class="number"><%= p1TotalClick / p1TotalPv * 100 %></span>%</td>
                        <td><span class="number"><%= p1TotalCost %></span></td>
                        <td><span class="number"><%= p1TotalCost / p1TotalClick %></span></td>
                        <td><span class="number"><%= p1TotalOrder %></span></td>
                        <td><span class="number"><%= p1TotalAmt %></span></td>
                        <td><span class="number"><%= p1TotalCart %></span></td>
                        <td><span class="number"><%= p1TotalFavItem %></span></td>
                        <td><span class="number"><%= p1TotalAmt / p1TotalCost %></span></td>
                        <td><span class="number"><%= (p1TotalOrder / p1TotalClick) * 100 %></span>%</td>
                        <td><span class="number"><%= Math.round(p1TotalCost / p1TotalOrder) %></span></td>
                    </tr>
                </table>
            </div>

            <div class="page">
                <%
                    var p2SubwayEc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p2SubwayFc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p2SubwayPc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    for (var i in ecRpt.subway.items) {
                        var item = ecRpt.subway.items[i];
                        p2SubwayEc.impression += item[5] ? parseInt(item[5]) : 0;
                        p2SubwayEc.click += item[6] ? parseInt(item[6]) : 0;
                        p2SubwayEc.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                        p2SubwayEc.order += item[17] ? parseInt(item[17]) : 0;
                        p2SubwayEc.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                        p2SubwayEc.cart += item[24] ? parseInt(item[24]) : 0.0;
                        p2SubwayEc.fav += item[24] ? parseInt(item[18]) : 0.0;
                    } 
                    p2SubwayEc.ctr = p2SubwayEc.impression > 0 ? p2SubwayEc.click / p2SubwayEc.impression * 100 : 0;
                    p2SubwayEc.cpc = p2SubwayEc.click > 0 ? p2SubwayEc.spend / p2SubwayEc.click : 0;
                    p2SubwayEc.roi = p2SubwayEc.spend > 0 ? p2SubwayEc.sale / p2SubwayEc.spend : 0;
                    p2SubwayEc.cvr = p2SubwayEc.click > 0 ? p2SubwayEc.order / p2SubwayEc.click * 100: 0;
                    p2SubwayEc.cpu = p2SubwayEc.order > 0 ? Math.round(p2SubwayEc.spend / p2SubwayEc.order) : 0;

                    for (var i in fcRpt.subway.items) {
                        var item = fcRpt.subway.items[i];
                        p2SubwayFc.impression += item[5] ? parseInt(item[5]) : 0;
                        p2SubwayFc.click += item[6] ? parseInt(item[6]) : 0;
                        p2SubwayFc.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                        p2SubwayFc.order += item[17] ? parseInt(item[17]) : 0;
                        p2SubwayFc.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                        p2SubwayFc.cart += item[24] ? parseInt(item[24]) : 0;
                        p2SubwayFc.fav += item[18] ? parseInt(item[18]) : 0;
                    } 
                    p2SubwayFc.ctr = p2SubwayFc.impression > 0 ? p2SubwayFc.click / p2SubwayFc.impression * 100 : 0;
                    p2SubwayFc.cpc = p2SubwayFc.click > 0 ? p2SubwayFc.spend / p2SubwayFc.click : 0;
                    p2SubwayFc.roi = p2SubwayFc.spend > 0 ? p2SubwayFc.sale / p2SubwayFc.spend : 0;
                    p2SubwayFc.cvr = p2SubwayFc.click > 0 ? p2SubwayFc.order / p2SubwayFc.click * 100: 0;
                    p2SubwayFc.cpu = p2SubwayFc.order > 0 ? Math.round(p2SubwayFc.spend / p2SubwayFc.order) : 0;

                    for (var i in pcRpt.subway.items) {
                        var item = pcRpt.subway.items[i];
                        p2SubwayPc.impression += item[5] ? parseInt(item[5]) : 0;
                        p2SubwayPc.click += item[6] ? parseInt(item[6]) : 0;
                        p2SubwayPc.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                        p2SubwayPc.order += item[17] ? parseInt(item[17]) : 0;
                        p2SubwayPc.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                        p2SubwayPc.cart += item[24] ? parseInt(item[24]) : 0;
                        p2SubwayPc.fav += item[18] ? parseInt(item[18]) : 0;
                    } 
                    p2SubwayPc.ctr = p2SubwayPc.impression > 0 ? p2SubwayPc.click / p2SubwayPc.impression * 100 : 0;
                    p2SubwayPc.cpc = p2SubwayPc.click > 0 ? p2SubwayPc.spend / p2SubwayPc.click : 0;
                    p2SubwayPc.roi = p2SubwayPc.spend > 0 ? p2SubwayPc.sale / p2SubwayPc.spend : 0;
                    p2SubwayPc.cvr = p2SubwayPc.click > 0 ? p2SubwayPc.order / p2SubwayPc.click * 100: 0;
                    p2SubwayPc.cpu = p2SubwayPc.order > 0 ? Math.round(p2SubwayPc.spend / p2SubwayPc.order) : 0;

                    var p2ZuanshiEc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p2ZuanshiFc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p2ZuanshiPc = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };

                    for (var i in ecRpt.zuanshi.campaigns) {
                        var campaign = ecRpt.zuanshi.campaigns[i];
                        p2ZuanshiEc.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p2ZuanshiEc.click += campaign.click ? parseInt(campaign.click) : 0;
                        p2ZuanshiEc.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p2ZuanshiEc.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p2ZuanshiEc.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0.0;
                        p2ZuanshiEc.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p2ZuanshiEc.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                    } 
                    p2ZuanshiEc.ctr = p2ZuanshiEc.impression > 0 ? p2ZuanshiEc.click / p2ZuanshiEc.impression * 100 : 0;
                    p2ZuanshiEc.cpc = p2ZuanshiEc.click > 0 ? p2ZuanshiEc.spend / p2ZuanshiEc.click : 0;
                    p2ZuanshiEc.roi = p2ZuanshiEc.spend > 0 ? p2ZuanshiEc.sale / p2ZuanshiEc.spend : 0;
                    p2ZuanshiEc.cvr = p2ZuanshiEc.click > 0 ? p2ZuanshiEc.order / p2ZuanshiEc.click * 100: 0;
                    p2ZuanshiEc.cpu = p2ZuanshiEc.order > 0 ? Math.round(p2ZuanshiEc.spend / p2ZuanshiEc.order) : 0;

                    for (var i in fcRpt.zuanshi.campaigns) {
                        var campaign = fcRpt.zuanshi.campaigns[i];
                        p2ZuanshiFc.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p2ZuanshiFc.click += campaign.click ? parseInt(campaign.click) : 0;
                        p2ZuanshiFc.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p2ZuanshiFc.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p2ZuanshiFc.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0.0;
                        p2ZuanshiFc.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p2ZuanshiFc.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                    } 
                    p2ZuanshiFc.ctr = p2ZuanshiFc.impression > 0 ? p2ZuanshiFc.click / p2ZuanshiFc.impression * 100 : 0;
                    p2ZuanshiFc.cpc = p2ZuanshiFc.click > 0 ? p2ZuanshiFc.spend / p2ZuanshiFc.click : 0;
                    p2ZuanshiFc.roi = p2ZuanshiFc.spend > 0 ? p2ZuanshiFc.sale / p2ZuanshiFc.spend : 0;
                    p2ZuanshiFc.cvr = p2ZuanshiFc.click > 0 ? p2ZuanshiFc.order / p2ZuanshiFc.click * 100: 0;
                    p2ZuanshiFc.cpu = p2ZuanshiFc.order > 0 ? Math.round(p2ZuanshiFc.spend / p2ZuanshiFc.order) : 0;

                    for (var i in pcRpt.zuanshi.campaigns) {
                        var campaign = pcRpt.zuanshi.campaigns[i];
                        p2ZuanshiPc.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p2ZuanshiPc.click += campaign.click ? parseInt(campaign.click) : 0;
                        p2ZuanshiPc.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p2ZuanshiPc.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p2ZuanshiPc.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p2ZuanshiPc.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                        p2ZuanshiPc.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0;
                    } 
                    p2ZuanshiPc.ctr = p2ZuanshiPc.impression > 0 ? p2ZuanshiPc.click / p2ZuanshiPc.impression * 100 : 0;
                    p2ZuanshiPc.cpc = p2ZuanshiPc.click > 0 ? p2ZuanshiPc.spend / p2ZuanshiPc.click : 0;
                    p2ZuanshiPc.roi = p2ZuanshiPc.spend > 0 ? p2ZuanshiPc.sale / p2ZuanshiPc.spend : 0;
                    p2ZuanshiPc.cvr = p2ZuanshiPc.click > 0 ? p2ZuanshiPc.order / p2ZuanshiPc.click * 100: 0;
                    p2ZuanshiPc.cpu = p2ZuanshiPc.order > 0 ? Math.round(p2ZuanshiPc.spend / p2ZuanshiPc.order) : 0;
                %>
                <div id="pageHeader-3">
                    <h3>直通车 & 钻展分类表现</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li>Key findings :xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr>
                            <th colspan="13">EC</th>
                        </tr>
                        <tr class="title">
                            <th>平台</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>直通车</td>
                            <td><span class="number"><%= p2SubwayEc.impression %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.click %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayEc.spend %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.cpc %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.order %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.sale %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.cart %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.fav %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.roi %></span></td> 
                            <td><span class="number"><%= p2SubwayEc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayEc.cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>钻展</td>
                            <td><span class="number"><%= p2ZuanshiEc.impression %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.click %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiEc.spend %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.cpc %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.order %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.sale %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.cart %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.fav %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.roi %></span></td> 
                            <td><span class="number"><%= p2ZuanshiEc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiEc.cpu %></span></td> 
                        </tr>
                    </table>

                    <br />
                    <table>
                        <tr>
                            <th colspan="13">FC</th>
                        </tr>
                        <tr class="title">
                            <th>平台</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>直通车</td>
                            <td><span class="number"><%= p2SubwayFc.impression %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.click %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayFc.spend %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.cpc %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.order %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.sale %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.cart %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.fav %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.roi %></span></td> 
                            <td><span class="number"><%= p2SubwayFc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayFc.cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>钻展</td>
                            <td><span class="number"><%= p2ZuanshiFc.impression %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.click %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiFc.spend %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.cpc %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.order %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.sale %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.cart %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.fav %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.roi %></span></td> 
                            <td><span class="number"><%= p2ZuanshiFc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiFc.cpu %></span></td> 
                        </tr>
                    </table>

                    <br />
                    <table>
                        <tr>
                            <th colspan="13">PC</th>
                        </tr>
                        <tr class="title">
                            <th>平台</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>直通车</td>
                            <td><span class="number"><%= p2SubwayPc.impression %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.click %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayPc.spend %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.cpc %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.order %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.sale %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.cart %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.fav %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.roi %></span></td> 
                            <td><span class="number"><%= p2SubwayPc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2SubwayPc.cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>钻展</td>
                            <td><span class="number"><%= p2ZuanshiPc.impression %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.click %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.ctr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiPc.spend %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.cpc %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.order %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.sale %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.cart %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.fav %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.roi %></span></td> 
                            <td><span class="number"><%= p2ZuanshiPc.cvr %></span>%</td> 
                            <td><span class="number"><%= p2ZuanshiPc.cpu %></span></td> 
                        </tr>
                    </table>
                </div>
            </div>

            <!--
                <div>
                    <div id="p2_subway_cost_chart" style="width:49%;float:left;height:300px;" data-ec="<%= p2SubwayEc.cost %>" data-fc="<%= p2SubwayFc.cost %>" data-pc="<%= p2SubwayPc.cost %>"></div>
                    <div id="p2_zuanshi_cost_chart" style="width:49%;float:left;height:300px;" data-ec="<%= p2ZuanshiEc.cost %>" data-fc="<%= p2ZuanshiFc.cost %>" data-pc="<%= p2ZuanshiPc.cost %>"></div>
                </div>
            -->
            <div class="page">
                <%
                    var p3SubwaySummary = {};
                    var p3ZuanshiSummary = {};
                    for (var i in subwayItemIncludeKeywordReports) {
                        var keywordRpt = subwayItemIncludeKeywordReports[i];
                        if ( ! p3SubwaySummary[i]) {
                            p3SubwaySummary[i] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            };
                        }
                        for (var j in keywordRpt) {
                            p3SubwaySummary[i].impression += keywordRpt[j][5] ? parseInt(keywordRpt[j][5]) : 0;
                            p3SubwaySummary[i].click += keywordRpt[j][6] ? parseInt(keywordRpt[j][6]) : 0;
                            p3SubwaySummary[i].spend += keywordRpt[j][7] ? parseFloat(keywordRpt[j][7]) / 100 : 0.0;
                            p3SubwaySummary[i].order += keywordRpt[j][17] ? parseInt(keywordRpt[j][17]) : 0;
                            p3SubwaySummary[i].sale += keywordRpt[j][16] ? parseFloat(keywordRpt[j][16]) / 100 : 0.0;
                            p3SubwaySummary[i].cart += keywordRpt[j][24] ? parseInt(keywordRpt[j][24]) : 0;
                            p3SubwaySummary[i].fav += keywordRpt[j][18] ? parseInt(keywordRpt[j][18]) : 0;
                        }
                        p3SubwaySummary[i].ctr = p3SubwaySummary[i].impression > 0 ? p3SubwaySummary[i].click / p3SubwaySummary[i].impression * 100 : 0;
                        p3SubwaySummary[i].cpc = p3SubwaySummary[i].click > 0 ? p3SubwaySummary[i].spend / p3SubwaySummary[i].click : 0;
                        p3SubwaySummary[i].roi = p3SubwaySummary[i].spend > 0 ? p3SubwaySummary[i].sale / p3SubwaySummary[i].spend : 0;
                        p3SubwaySummary[i].cvr = p3SubwaySummary[i].click > 0 ? p3SubwaySummary[i].order / p3SubwaySummary[i].click * 100 : 0;
                        p3SubwaySummary[i].cpu = p3SubwaySummary[i].order > 0 ? Math.round(p3SubwaySummary[i].spend / p3SubwaySummary[i].order) : 0;
                    }

                    for (var i in zuanshiCampaignIncludeKeywordReports) {
                        var keywordRpt = zuanshiCampaignIncludeKeywordReports[i];
                        if ( ! p3ZuanshiSummary[i]) {
                            p3ZuanshiSummary[i] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            };
                        }
                        for (var j in keywordRpt) {
                            p3ZuanshiSummary[i].impression += keywordRpt[j].adPv ? parseInt(keywordRpt[j].adPv) : 0;
                            p3ZuanshiSummary[i].click += keywordRpt[j].click ? parseInt(keywordRpt[j].click) : 0;
                            p3ZuanshiSummary[i].spend += keywordRpt[j].charge ? parseFloat(keywordRpt[j].charge) : 0.0;
                            p3ZuanshiSummary[i].order += keywordRpt[j].alipayInShopNum ? parseInt(keywordRpt[j].alipayInShopNum) : 0;
                            p3ZuanshiSummary[i].sale += keywordRpt[j].alipayInshopAmt ? parseFloat(keywordRpt[j].alipayInshopAmt) : 0.0;
                            p3ZuanshiSummary[i].cart += keywordRpt[j].cartNum ? parseInt(keywordRpt[j].cartNum) : 0;
                            p3ZuanshiSummary[i].fav += keywordRpt[j].inshopItemColNum ? parseInt(keywordRpt[j].inshopItemColNum) : 0;
                        }
                        p3ZuanshiSummary[i].ctr = p3ZuanshiSummary[i].impression > 0 ? p3ZuanshiSummary[i].click / p3ZuanshiSummary[i].impression * 100 : 0;
                        p3ZuanshiSummary[i].cpc = p3ZuanshiSummary[i].click > 0 ? p3ZuanshiSummary[i].spend / p3ZuanshiSummary[i].click : 0;
                        p3ZuanshiSummary[i].roi = p3ZuanshiSummary[i].spend > 0 ? p3ZuanshiSummary[i].sale / p3ZuanshiSummary[i].spend : 0;
                        p3ZuanshiSummary[i].cvr = p3ZuanshiSummary[i].click > 0 ? p3ZuanshiSummary[i].order / p3ZuanshiSummary[i].click * 100: 0;
                        p3ZuanshiSummary[i].cpu = p3ZuanshiSummary[i].order > 0 ? Math.round(p3ZuanshiSummary[i].spend / p3ZuanshiSummary[i].order) : 0;
                    }
                %>
                <div id="pageHeader-4">
                    <h3>Weekly Review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li>直通车 & 钻展子分类表现</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>渠道</th>
                            <th>DD</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p3SubwaySummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= Object.keys(subwayItemIncludeKeywords).length %>">直通车</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p3SubwaySummary[i].impression %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].click %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p3SubwaySummary[i].spend %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].order %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].sale %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].cart %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].fav %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].roi %></span></td> 
                                <td><span class="number"><%= p3SubwaySummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p3SubwaySummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="title">
                            <th>渠道</th>
                            <th>DD</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p3ZuanshiSummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= zuanshiCampaignIncludeKeywords.length + 1 %>">钻展</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p3ZuanshiSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].click %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].order %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                    </table>
                </div>
            </div>

            <div class="page">
                <%
                    var p5SubwayECActivity = ['AM10', 'AM11', 'HP01'];
                    var p5SubwayECNormal = [];
                    var p5SubwayECSummary = {};
                    var p5ActivitySummary = {};
                    var p5NormalSummary = {};
                    var p5ActivityTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p5NormalTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p5ProtectTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    for (var i in subwayItemReports) {
                        var item = subwayItemReports[i];
                        if (item[1].indexOf('品牌保护EC计划') > -1) {
                            p5ProtectTotal.impression += item[5] ? parseInt(item[5]) : 0;
                            p5ProtectTotal.click += item[6] ? parseInt(item[6]) : 0;
                            p5ProtectTotal.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                            p5ProtectTotal.order += item[17] ? parseInt(item[17]) : 0;
                            p5ProtectTotal.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                            p5ProtectTotal.cart += item[24] ? parseInt(item[24]) : 0.0;
                            p5ProtectTotal.fav += item[18] ? parseInt(item[18]) : 0;
                        }
                    } 
                    p5ProtectTotal.ctr = p5ProtectTotal.impression > 0 ? p5ProtectTotal.click / p5ProtectTotal.impression * 100 : 0;
                    p5ProtectTotal.cpc = p5ProtectTotal.click > 0 ? p5ProtectTotal.spend / p5ProtectTotal.click : 0;
                    p5ProtectTotal.roi = p5ProtectTotal.spend > 0 ? p5ProtectTotal.sale / p5ProtectTotal.spend : 0;
                    p5ProtectTotal.cvr = p5ProtectTotal.click > 0 ? p5ProtectTotal.order / p5ProtectTotal.click * 100: 0;
                    p5ProtectTotal.cpu = p5ProtectTotal.order > 0 ? Math.round(p5ProtectTotal.spend / p5ProtectTotal.order) : 0;

                    for (var i in p5SubwayECActivity) {
                        var name = p5SubwayECActivity[i];
                        if ( ! p5ActivitySummary[name]) {
                            p5ActivitySummary[name] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            }                            
                        }
                        for (var j in ecRpt.subway.items) {
                            var item = ecRpt.subway.items[j];
                            if (item[2].toUpperCase().indexOf(name) > -1) {
                                p5ActivitySummary[name].impression += item[5] ? parseInt(item[5]) : 0;
                                p5ActivitySummary[name].click += item[6] ? parseInt(item[6]) : 0;
                                p5ActivitySummary[name].spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                                p5ActivitySummary[name].order += item[17] ? parseInt(item[17]) : 0;
                                p5ActivitySummary[name].sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                                p5ActivitySummary[name].cart += item[24] ? parseInt(item[24]) : 0;
                                p5ActivitySummary[name].fav += item[18] ? parseInt(item[18]) : 0;
                            }
                            p5ActivitySummary[name].ctr = p5ActivitySummary[name].impression > 0 ? p5ActivitySummary[name].click / p5ActivitySummary[name].impression * 100 : 0;
                            p5ActivitySummary[name].cpc = p5ActivitySummary[name].click > 0 ? p5ActivitySummary[name].spend / p5ActivitySummary[name].click : 0;
                            p5ActivitySummary[name].roi = p5ActivitySummary[name].spend > 0 ? p5ActivitySummary[name].sale / p5ActivitySummary[name].spend : 0;
                            p5ActivitySummary[name].cvr = p5ActivitySummary[name].click > 0 ? p5ActivitySummary[name].order / p5ActivitySummary[name].click * 100: 0;
                            p5ActivitySummary[name].cpu = p5ActivitySummary[name].order > 0 ? Math.round(p5ActivitySummary[name].spend / p5ActivitySummary[name].order) : 0;
                        }
                        p5ActivityTotal.impression += p5ActivitySummary[name].impression;
                        p5ActivityTotal.click += p5ActivitySummary[name].click;
                        p5ActivityTotal.spend += p5ActivitySummary[name].spend;
                        p5ActivityTotal.order += p5ActivitySummary[name].order;
                        p5ActivityTotal.sale += p5ActivitySummary[name].sale;
                        p5ActivityTotal.cart += p5ActivitySummary[name].cart;
                        p5ActivityTotal.fav += p5ActivitySummary[name].fav;
                    }

                    for (var i in p5SubwayECNormal) {
                        var name = p5SubwayECNormal[i];
                        if ( ! p5NormalSummary[name]) {
                            p5NormalSummary[name] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            }                            
                        }
                        for (var j in ecRpt.subway.items) {
                            var item = ecRpt.subway.items[j];
                            if (item[2].toUpperCase().indexOf(name) > -1) {
                                p5NormalSummary[name].impression += item[5] ? parseInt(item[5]) : 0;
                                p5NormalSummary[name].click += item[6] ? parseInt(item[6]) : 0;
                                p5NormalSummary[name].spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                                p5NormalSummary[name].order += item[17] ? parseInt(item[17]) : 0;
                                p5NormalSummary[name].sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                                p5NormalSummary[name].cart += item[24] ? parseInt(item[24]) : 0.0;
                                p5NormalSummary[name].fav += item[18] ? parseInt(item[18]) : 0.0;
                            }
                            p5NormalSummary[name].ctr = p5NormalSummary[name].impression > 0 ? p5NormalSummary[name].click / p5NormalSummary[name].impression * 100 : 0;
                            p5NormalSummary[name].cpc = p5NormalSummary[name].click > 0 ? p5NormalSummary[name].spend / p5NormalSummary[name].click : 0;
                            p5NormalSummary[name].roi = p5NormalSummary[name].spend > 0 ? p5NormalSummary[name].sale / p5NormalSummary[name].spend : 0;
                            p5NormalSummary[name].cvr = p5NormalSummary[name].click > 0 ? p5NormalSummary[name].order / p5NormalSummary[name].click * 100: 0;
                            p5NormalSummary[name].cpu = p5NormalSummary[name].spend > 0 ? Math.round(p5NormalSummary[name].spend / p5NormalSummary[name].order) : 0;
                        }
                        p5NormalTotal.impression += p5NormalSummary[name].impression;
                        p5NormalTotal.click += p5NormalSummary[name].click;
                        p5NormalTotal.spend += p5NormalSummary[name].spend;
                        p5NormalTotal.order += p5NormalSummary[name].order;
                        p5NormalTotal.sale += p5NormalSummary[name].sale;
                        p5NormalTotal.cart += p5NormalSummary[name].cart;
                        p5NormalTotal.fav += p5NormalSummary[name].fav;
                    }

                    p5ActivityTotal.ctr = p5ActivityTotal.impression > 0 ? p5ActivityTotal.click / p5ActivityTotal.impression * 100 : 0;
                    p5ActivityTotal.cpc = p5ActivityTotal.click > 0 ? p5ActivityTotal.spend / p5ActivityTotal.click : 0;
                    p5ActivityTotal.roi = p5ActivityTotal.spend > 0 ? p5ActivityTotal.sale / p5ActivityTotal.spend : 0;
                    p5ActivityTotal.cvr = p5ActivityTotal.click > 0 ? p5ActivityTotal.order / p5ActivityTotal.click * 100: 0;
                    p5ActivityTotal.cpu = p5ActivityTotal.order > 0 ? Math.round(p5ActivityTotal.spend / p5ActivityTotal.order) : 0;
                    p5NormalTotal.ctr = p5NormalTotal.impression > 0 ? p5NormalTotal.click / p5NormalTotal.impression * 100 : 0;
                    p5NormalTotal.cpc = p5NormalTotal.click > 0 ? p5NormalTotal.spend / p5NormalTotal.click : 0;
                    p5NormalTotal.roi = p5NormalTotal.spend > 0 ? p5NormalTotal.sale / p5NormalTotal.spend : 0;
                    p5NormalTotal.cvr = p5NormalTotal.click > 0 ? p5NormalTotal.order / p5NormalTotal.click * 100: 0;
                    p5NormalTotal.cpu = p5NormalTotal.order > 0 ? Math.round(p5NormalTotal.spend / p5NormalTotal.order) : 0;
                %>
                <%
                    var p6SubwayFCActivity = ['V6Motorhead', 'V6Origin', 'V6Mattress', 'V8Fluffy', 'V8Absolute', 'V6Car', 'CY22'];
                    var p6SubwayFCNormal = [];
                    var p6ActivitySummary = {};
                    var p6NormalSummary = {};
                    var p6ActivityTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0,
                    };
                    var p6NormalTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0,
                    };
                    var p6ProtectTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0,
                    };

                    for (var i in subwayItemReports) {
                        var item = subwayItemReports[i];
                        if (item[1].indexOf('品牌保护FC计划') > -1 && ! products.pc.test(item[2])) {
                            p6ProtectTotal.impression += item[5] ? parseInt(item[5]) : 0;
                            p6ProtectTotal.click += item[6] ? parseInt(item[6]) : 0;
                            p6ProtectTotal.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                            p6ProtectTotal.order += item[17] ? parseInt(item[17]) : 0;
                            p6ProtectTotal.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                            p6ProtectTotal.cart += item[24] ? parseInt(item[24]) : 0;
                            p6ProtectTotal.fav += item[18] ? parseInt(item[18]) : 0;
                        }
                    } 
                    p6ProtectTotal.ctr = p6ProtectTotal.impression > 0 ? p6ProtectTotal.click / p6ProtectTotal.impression * 100 : 0;
                    p6ProtectTotal.cpc = p6ProtectTotal.click > 0 ? p6ProtectTotal.spend / p6ProtectTotal.click : 0;
                    p6ProtectTotal.roi = p6ProtectTotal.spend > 0 ? p6ProtectTotal.sale / p6ProtectTotal.spend : 0;
                    p6ProtectTotal.cvr = p6ProtectTotal.click > 0 ? p6ProtectTotal.order / p6ProtectTotal.click * 100: 0;
                    p6ProtectTotal.cpu = p6ProtectTotal.order > 0 ? Math.round(p6ProtectTotal.spend / p6ProtectTotal.order) : 0;

                    for (var i in p6SubwayFCActivity) {
                        var name = p6SubwayFCActivity[i];
                        if ( ! p6ActivitySummary[name]) {
                            p6ActivitySummary[name] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            }                            
                        }
                        for (var j in fcRpt.subway.items) {
                            var item = fcRpt.subway.items[j];
                            if (item[2].toUpperCase().replace(/\s/ig, '').indexOf(name.toUpperCase().replace(/\s/ig, '')) > -1) {
                                p6ActivitySummary[name].impression += item[5] ? parseInt(item[5]) : 0;
                                p6ActivitySummary[name].click += item[6] ? parseInt(item[6]) : 0;
                                p6ActivitySummary[name].spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                                p6ActivitySummary[name].order += item[17] ? parseInt(item[17]) : 0;
                                p6ActivitySummary[name].sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                                p6ActivitySummary[name].cart += item[24] ? parseInt(item[24]) : 0.0;
                                p6ActivitySummary[name].fav += item[18] ? parseInt(item[18]) : 0.0;
                            }
                            p6ActivitySummary[name].ctr = p6ActivitySummary[name].impression > 0 ? p6ActivitySummary[name].click / p6ActivitySummary[name].impression * 100 : 0;
                            p6ActivitySummary[name].cpc = p6ActivitySummary[name].click > 0 ? p6ActivitySummary[name].spend / p6ActivitySummary[name].click : 0;
                            p6ActivitySummary[name].roi = p6ActivitySummary[name].spend > 0 ? p6ActivitySummary[name].sale / p6ActivitySummary[name].spend : 0;
                            p6ActivitySummary[name].cvr = p6ActivitySummary[name].click > 0 ? p6ActivitySummary[name].order / p6ActivitySummary[name].click * 100: 0;
                            p6ActivitySummary[name].cpu = p6ActivitySummary[name].order > 0 ? Math.round(p6ActivitySummary[name].spend / p6ActivitySummary[name].order) : 0;
                        }
                        p6ActivityTotal.impression += p6ActivitySummary[name].impression;
                        p6ActivityTotal.click += p6ActivitySummary[name].click;
                        p6ActivityTotal.spend += p6ActivitySummary[name].spend;
                        p6ActivityTotal.order += p6ActivitySummary[name].order;
                        p6ActivityTotal.sale += p6ActivitySummary[name].sale;
                        p6ActivityTotal.cart += p6ActivitySummary[name].cart;
                        p6ActivityTotal.fav += p6ActivitySummary[name].fav;
                    }

                    for (var i in p6SubwayFCNormal) {
                        var name = p6SubwayFCNormal[i];
                        if ( ! p6NormalSummary[name]) {
                            p6NormalSummary[name] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            }                            
                        }
                        for (var j in fcRpt.subway.items) {
                            var item = fcRpt.subway.items[j];
                            if (item[2].toUpperCase().replace(/\s/ig, '').indexOf(name.toUpperCase().replace(/\s/ig, '')) > -1) {
                                p6NormalSummary[name].impression += item[5] ? parseInt(item[5]) : 0;
                                p6NormalSummary[name].click += item[6] ? parseInt(item[6]) : 0;
                                p6NormalSummary[name].spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                                p6NormalSummary[name].order += item[17] ? parseInt(item[17]) : 0;
                                p6NormalSummary[name].sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                                p6NormalSummary[name].cart += item[24] ? parseFloat(item[24]) : 0;
                                p6NormalSummary[name].fav += item[18] ? parseFloat(item[18]) : 0;
                            }
                            p6NormalSummary[name].ctr = p6NormalSummary[name].impression > 0 ? p6NormalSummary[name].click / p6NormalSummary[name].impression * 100 : 0;
                            p6NormalSummary[name].cpc = p6NormalSummary[name].click > 0 ? p6NormalSummary[name].spend / p6NormalSummary[name].click : 0;
                            p6NormalSummary[name].roi = p6NormalSummary[name].spend > 0 ? p6NormalSummary[name].sale / p6NormalSummary[name].spend : 0;
                            p6NormalSummary[name].cvr = p6NormalSummary[name].click > 0 ? p6NormalSummary[name].order / p6NormalSummary[name].click * 100: 0;
                            p6NormalSummary[name].cpu = p6NormalSummary[name].order > 0 ? Math.round(p6NormalSummary[name].spend / p6NormalSummary[name].order) : 0;
                        }
                        p6NormalTotal.impression += p6NormalSummary[name].impression;
                        p6NormalTotal.click += p6NormalSummary[name].click;
                        p6NormalTotal.spend += p6NormalSummary[name].spend;
                        p6NormalTotal.order += p6NormalSummary[name].order;
                        p6NormalTotal.sale += p6NormalSummary[name].sale;
                        p6NormalTotal.cart += p6NormalSummary[name].cart;
                        p6NormalTotal.fav += p6NormalSummary[name].fav;
                    }

                    p6ActivityTotal.ctr = p6ActivityTotal.impression > 0 ? p6ActivityTotal.click / p6ActivityTotal.impression * 100 : 0;
                    p6ActivityTotal.cpc = p6ActivityTotal.click > 0 ? p6ActivityTotal.spend / p6ActivityTotal.click : 0;
                    p6ActivityTotal.roi = p6ActivityTotal.spend > 0 ? p6ActivityTotal.sale / p6ActivityTotal.spend : 0;
                    p6ActivityTotal.cvr = p6ActivityTotal.click > 0 ? p6ActivityTotal.order / p6ActivityTotal.click * 100: 0;
                    p6ActivityTotal.cpu = p6ActivityTotal.order > 0 ? Math.round(p6ActivityTotal.spend / p6ActivityTotal.order) : 0;
                    p6NormalTotal.ctr = p6NormalTotal.impression > 0 ? p6NormalTotal.click / p6NormalTotal.impression * 100 : 0;
                    p6NormalTotal.cpc = p6NormalTotal.click > 0 ? p6NormalTotal.spend / p6NormalTotal.click : 0;
                    p6NormalTotal.roi = p6NormalTotal.spend > 0 ? p6NormalTotal.sale / p6NormalTotal.spend : 0;
                    p6NormalTotal.cvr = p6NormalTotal.click > 0 ? p6NormalTotal.order / p6NormalTotal.click * 100: 0;
                    p6NormalTotal.cpu = p6NormalTotal.order > 0 ? Math.round(p6NormalTotal.spend / p6NormalTotal.order) : 0;
                %>
                <%
                    var p7PCSubwayPCActivity = ['HD01'];
                    var p7PCActivitySummary = {};
                    var p7PCActivityTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p7ProtectTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    for (var i in subwayItemReports) {
                        var item = subwayItemReports[i];
                        if (item[1].indexOf('品牌保护FC计划') > -1 && products.pc.test(item[2])) {
                            p7ProtectTotal.impression += item[5] ? parseInt(item[5]) : 0;
                            p7ProtectTotal.click += item[6] ? parseInt(item[6]) : 0;
                            p7ProtectTotal.spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                            p7ProtectTotal.order += item[17] ? parseInt(item[17]) : 0;
                            p7ProtectTotal.sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                            p7ProtectTotal.cart += item[24] ? parseInt(item[24]) : 0;
                            p7ProtectTotal.fav += item[18] ? parseInt(item[18]) : 0;
                        }
                    } 
                    p7ProtectTotal.ctr = p7ProtectTotal.impression > 0 ? p7ProtectTotal.click / p7ProtectTotal.impression * 100 : 0;
                    p7ProtectTotal.cpc = p7ProtectTotal.click > 0 ? p7ProtectTotal.spend / p7ProtectTotal.click : 0;
                    p7ProtectTotal.roi = p7ProtectTotal.spend > 0 ? p7ProtectTotal.sale / p7ProtectTotal.spend : 0;
                    p7ProtectTotal.cvr = p7ProtectTotal.click > 0 ? p7ProtectTotal.order / p7ProtectTotal.click * 100: 0;
                    p7ProtectTotal.cpu = p7ProtectTotal.order > 0 ? Math.round(p7ProtectTotal.spend / p7ProtectTotal.order) : 0;

                    for (var i in p7PCSubwayPCActivity) {
                        var name = p7PCSubwayPCActivity[i];
                        if ( ! p7PCActivitySummary[name]) {
                            p7PCActivitySummary[name] = {
                                impression: 0,
                                click: 0,
                                ctr: 0,
                                spend: 0,
                                cpc: 0,
                                order: 0,
                                sale: 0,
                                cart: 0,
                                fav: 0,
                                roi: 0,
                                cvr: 0,
                                cpu: 0
                            }                            
                        }
                        for (var j in pcRpt.subway.items) {
                            var item = pcRpt.subway.items[j];
                            if (item[2].toUpperCase().replace(/\s/ig, '').indexOf(name.toUpperCase().replace(/\s/ig, '')) > -1) {
                                p7PCActivitySummary[name].impression += item[5] ? parseInt(item[5]) : 0;
                                p7PCActivitySummary[name].click += item[6] ? parseInt(item[6]) : 0;
                                p7PCActivitySummary[name].spend += item[7] ? parseFloat(item[7]) / 100 : 0.0;
                                p7PCActivitySummary[name].order += item[17] ? parseInt(item[17]) : 0;
                                p7PCActivitySummary[name].sale += item[16] ? parseFloat(item[16]) / 100 : 0.0;
                                p7PCActivitySummary[name].cart += item[24] ? parseInt(item[24]) : 0;
                                p7PCActivitySummary[name].fav += item[18] ? parseInt(item[18]) : 0;
                            }
                            p7PCActivitySummary[name].ctr = p7PCActivitySummary[name].impression > 0 ? p7PCActivitySummary[name].click / p7PCActivitySummary[name].impression * 100 : 0;
                            p7PCActivitySummary[name].cpc = p7PCActivitySummary[name].click > 0 ? p7PCActivitySummary[name].spend / p7PCActivitySummary[name].click : 0;
                            p7PCActivitySummary[name].roi = p7PCActivitySummary[name].spend > 0 ? p7PCActivitySummary[name].sale / p7PCActivitySummary[name].spend : 0;
                            p7PCActivitySummary[name].cvr = p7PCActivitySummary[name].click > 0 ? p7PCActivitySummary[name].order / p7PCActivitySummary[name].click * 100: 0;
                            p7PCActivitySummary[name].cpu = p7PCActivitySummary[name].order > 0 ? Math.round(p7PCActivitySummary[name].spend / p7PCActivitySummary[name].order) : 0;
                        }
                        p7PCActivityTotal.impression += p7PCActivitySummary[name].impression;
                        p7PCActivityTotal.click += p7PCActivitySummary[name].click;
                        p7PCActivityTotal.spend += p7PCActivitySummary[name].spend;
                        p7PCActivityTotal.order += p7PCActivitySummary[name].order;
                        p7PCActivityTotal.sale += p7PCActivitySummary[name].sale;
                        p7PCActivityTotal.cart += p7PCActivitySummary[name].cart;
                        p7PCActivityTotal.fav += p7PCActivitySummary[name].fav;
                    }

                    p7PCActivityTotal.ctr = p7PCActivityTotal.impression > 0 ? p7PCActivityTotal.click / p7PCActivityTotal.impression * 100 : 0;
                    p7PCActivityTotal.cpc = p7PCActivityTotal.click > 0 ? p7PCActivityTotal.spend / p7PCActivityTotal.click : 0;
                    p7PCActivityTotal.roi = p7PCActivityTotal.spend > 0 ? p7PCActivityTotal.sale / p7PCActivityTotal.spend : 0;
                    p7PCActivityTotal.cvr = p7PCActivityTotal.click > 0 ? p7PCActivityTotal.order / p7PCActivityTotal.click * 100 : 0;
                    p7PCActivityTotal.cpu = p7PCActivityTotal.order > 0 ? Math.round(p7PCActivityTotal.spend / p7PCActivityTotal.order) : 0;
                %>
                <%
                    var p8ECKeywordSummary = {};
                    var p9ECKeywordSummary = {};
                    var p9ECKeywordProducts = new RegExp('AM10|HP01|HP02', 'i');
                    for (var i in subwayKeywordReports) {
                        var keyword = subwayKeywordReports[i],
                            word = keyword[3].replace(/%s/ig, '').toLowerCase(),
                            title = keyword[2].replace(/%s/ig, '').toLowerCase();
                        if (word && keyword[1].indexOf('品牌保护EC') > -1) {
                            if ( ! p8ECKeywordSummary[word]) {
                                p8ECKeywordSummary[word] = {
                                    word: word,
                                    impression: 0,
                                    ctr: 0,
                                    click: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0                                  
                                }
                            }
                            p8ECKeywordSummary[word].impression += keyword[6] ? parseInt(keyword[6]) : 0;
                            p8ECKeywordSummary[word].click += keyword[7] ? parseInt(keyword[7]) : 0;
                            p8ECKeywordSummary[word].spend += keyword[8] ? parseFloat(keyword[8]) / 100 : 0.0;
                            p8ECKeywordSummary[word].order += keyword[19] ? parseInt(keyword[19]) : 0;
                            p8ECKeywordSummary[word].sale += keyword[18] ? parseFloat(keyword[18]) / 100 : 0.0;
                            p8ECKeywordSummary[word].cart += keyword[24] ? parseInt(keyword[24]) : 0;
                            p8ECKeywordSummary[word].fav += keyword[20] ? parseInt(keyword[20]) : 0;
                        }
                        if (word && (keyword[1].indexOf('品牌保护EC') > -1 || keyword[1].indexOf('EC品类') > -1 || keyword[1].indexOf('EC转化') > -1) && p9ECKeywordProducts.test(title)) {
                            if ( ! p9ECKeywordSummary[word]) {
                                p9ECKeywordSummary[word] = {
                                    word: word,
                                    impression: 0,
                                    ctr: 0,
                                    click: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0                                  
                                }
                            }
                            p9ECKeywordSummary[word].impression += keyword[6] ? parseInt(keyword[6]) : 0;
                            p9ECKeywordSummary[word].click += keyword[7] ? parseInt(keyword[7]) : 0;
                            p9ECKeywordSummary[word].spend += keyword[8] ? parseFloat(keyword[8]) / 100 : 0.0;
                            p9ECKeywordSummary[word].order += keyword[19] ? parseInt(keyword[19]) : 0;
                            p9ECKeywordSummary[word].sale += keyword[18] ? parseFloat(keyword[18]) / 100 : 0.0;
                            p9ECKeywordSummary[word].cart += keyword[24] ? parseInt(keyword[24]) : 0;
                            p9ECKeywordSummary[word].fav += keyword[20] ? parseInt(keyword[20]) : 0;
                        }
                    }
                    var p8ECKeywordSummaryArr = [];
                    for (var j in p8ECKeywordSummary) {
                        p8ECKeywordSummary[j].ctr = p8ECKeywordSummary[j].impression > 0 ? p8ECKeywordSummary[j].click / p8ECKeywordSummary[j].impression * 100 : 0;
                        p8ECKeywordSummary[j].cpc = p8ECKeywordSummary[j].click > 0 ? p8ECKeywordSummary[j].spend / p8ECKeywordSummary[j].click : 0;
                        p8ECKeywordSummary[j].roi = p8ECKeywordSummary[j].spend > 0 ? p8ECKeywordSummary[j].sale / p8ECKeywordSummary[j].spend : 0;
                        p8ECKeywordSummary[j].cvr = p8ECKeywordSummary[j].click > 0 ? p8ECKeywordSummary[j].order / p8ECKeywordSummary[j].click * 100 : 0;
                        p8ECKeywordSummary[j].cpu = p8ECKeywordSummary[j].order > 0 ? Math.round(p8ECKeywordSummary[j].spend / p8ECKeywordSummary[j].order) : 0;
                        p8ECKeywordSummaryArr.push(p8ECKeywordSummary[j]);
                    }
                    
                    p8ECKeywordSummaryArr.sort(function(a, b) {
                        return parseInt(b.click) - parseInt(a.click);
                    });

                    var p9ECKeywordSummaryArr = [];
                    for (var j in p9ECKeywordSummary) {
                        p9ECKeywordSummary[j].ctr = p9ECKeywordSummary[j].impression > 0 ? p9ECKeywordSummary[j].click / p9ECKeywordSummary[j].impression * 100 : 0;
                        p9ECKeywordSummary[j].cpc = p9ECKeywordSummary[j].click > 0 ? p9ECKeywordSummary[j].spend / p9ECKeywordSummary[j].click : 0;
                        p9ECKeywordSummary[j].roi = p9ECKeywordSummary[j].spend > 0 ? p9ECKeywordSummary[j].sale / p9ECKeywordSummary[j].spend : 0;
                        p9ECKeywordSummary[j].cvr = p9ECKeywordSummary[j].click > 0 ? p9ECKeywordSummary[j].order / p9ECKeywordSummary[j].click * 100 : 0;
                        p9ECKeywordSummary[j].cpu = p9ECKeywordSummary[j].order > 0 ? Math.round(p9ECKeywordSummary[j].spend / p9ECKeywordSummary[j].order) : 0;
                        p9ECKeywordSummaryArr.push(p9ECKeywordSummary[j]);
                    }
                    
                    p9ECKeywordSummaryArr.sort(function(a, b) {
                        return parseInt(b.click) - parseInt(a.click);
                    });
                %>
                <%
                    var p10FCKeywordSummary = {};
                    var p11FCKeywordSummary = {};
                    var p11FCKeywordProducts = new RegExp('V6Motorhead|V6Origin|V6Fluffy|V8|V6Mattress', 'i');
                    for (var i in subwayKeywordReports) {
                        var keyword = subwayKeywordReports[i],
                            word = keyword[3].replace(/%s/ig, '').toLowerCase(),
                            title = keyword[2].replace(/%s/ig, '').toLowerCase();
                        if (word && keyword[1].indexOf('品牌保护FC') > -1 && keyword[2].indexOf('吹风机') === -1) {
                            if ( ! p10FCKeywordSummary[word]) {
                                p10FCKeywordSummary[word] = {
                                    word: word,
                                    impression: 0,
                                    ctr: 0,
                                    click: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0                                  
                                }
                            }
                            p10FCKeywordSummary[word].impression += keyword[6] ? parseInt(keyword[6]) : 0;
                            p10FCKeywordSummary[word].click += keyword[7] ? parseInt(keyword[7]) : 0;
                            p10FCKeywordSummary[word].spend += keyword[8] ? parseFloat(keyword[8]) / 100 : 0.0;
                            p10FCKeywordSummary[word].order += keyword[19] ? parseInt(keyword[19]) : 0;
                            p10FCKeywordSummary[word].sale += keyword[18] ? parseFloat(keyword[18]) / 100 : 0.0;
                            p10FCKeywordSummary[word].cart += keyword[24] ? parseInt(keyword[24]) : 0;
                            p10FCKeywordSummary[word].fav += keyword[20] ? parseInt(keyword[20]) : 0;
                        }
                        if (word && (keyword[1].indexOf('品牌保护FC') > -1 || keyword[1].indexOf('FC品类') > -1 || keyword[1].indexOf('FC转化') > -1) && keyword[2].indexOf('吹风机') === -1 && p11FCKeywordProducts.test(title)) {
                            if ( ! p11FCKeywordSummary[word]) {
                                p11FCKeywordSummary[word] = {
                                    word: word,
                                    impression: 0,
                                    ctr: 0,
                                    click: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0                                  
                                }
                            }
                            p11FCKeywordSummary[word].impression += keyword[6] ? parseInt(keyword[6]) : 0;
                            p11FCKeywordSummary[word].click += keyword[7] ? parseInt(keyword[7]) : 0;
                            p11FCKeywordSummary[word].spend += keyword[8] ? parseFloat(keyword[8]) / 100 : 0.0;
                            p11FCKeywordSummary[word].order += keyword[19] ? parseInt(keyword[19]) : 0;
                            p11FCKeywordSummary[word].sale += keyword[18] ? parseFloat(keyword[18]) / 100 : 0.0;
                            p11FCKeywordSummary[word].cart += keyword[24] ? parseInt(keyword[24]) : 0;
                            p11FCKeywordSummary[word].fav += keyword[20] ? parseInt(keyword[20]) : 0;
                        }
                    }
                    var p10FCKeywordSummaryArr = [];
                    for (var j in p10FCKeywordSummary) {
                        p10FCKeywordSummary[j].ctr = p10FCKeywordSummary[j].impression > 0 ? p10FCKeywordSummary[j].click / p10FCKeywordSummary[j].impression * 100 : 0;
                        p10FCKeywordSummary[j].cpc = p10FCKeywordSummary[j].click > 0 ? p10FCKeywordSummary[j].spend / p10FCKeywordSummary[j].click : 0;
                        p10FCKeywordSummary[j].roi = p10FCKeywordSummary[j].spend > 0 ? p10FCKeywordSummary[j].sale / p10FCKeywordSummary[j].spend : 0;
                        p10FCKeywordSummary[j].cvr = p10FCKeywordSummary[j].click > 0 ? p10FCKeywordSummary[j].order / p10FCKeywordSummary[j].click * 100 : 0;
                        p10FCKeywordSummary[j].cpu = p10FCKeywordSummary[j].order > 0 ? Math.round(p10FCKeywordSummary[j].spend / p10FCKeywordSummary[j].order) : 0;
                        p10FCKeywordSummaryArr.push(p10FCKeywordSummary[j]);
                    }
                    
                    p10FCKeywordSummaryArr.sort(function(a, b) {
                        return parseInt(b.click) - parseInt(a.click);
                    });

                    var p11FCKeywordSummaryArr = [];
                    for (var j in p11FCKeywordSummary) {
                        p11FCKeywordSummary[j].ctr = p11FCKeywordSummary[j].impression > 0 ? p11FCKeywordSummary[j].click / p11FCKeywordSummary[j].impression * 100 : 0;
                        p11FCKeywordSummary[j].cpc = p11FCKeywordSummary[j].click > 0 ? p11FCKeywordSummary[j].spend / p11FCKeywordSummary[j].click : 0;
                        p11FCKeywordSummary[j].roi = p11FCKeywordSummary[j].spend > 0 ? p11FCKeywordSummary[j].sale / p11FCKeywordSummary[j].spend : 0;
                        p11FCKeywordSummary[j].cvr = p11FCKeywordSummary[j].click > 0 ? p11FCKeywordSummary[j].order / p11FCKeywordSummary[j].click * 100 : 0;
                        p11FCKeywordSummary[j].cpu = p11FCKeywordSummary[j].order > 0 ? Math.round(p11FCKeywordSummary[j].spend / p11FCKeywordSummary[j].order) : 0;
                        p11FCKeywordSummaryArr.push(p11FCKeywordSummary[j]);
                    }
                    
                    p11FCKeywordSummaryArr.sort(function(a, b) {
                        return parseInt(b.click) - parseInt(a.click);
                    });
                %>
                <%
                    var p12PCKeywordSummary = {};
                    for (var i in subwayKeywordReports) {
                        var keyword = subwayKeywordReports[i],
                            word = keyword[3].replace(/%s/ig, '').toLowerCase();
                        if (word && keyword[1].indexOf('品牌保护FC') > -1 && keyword[2].indexOf('吹风机') > -1) {
                            if ( ! p12PCKeywordSummary[word]) {
                                p12PCKeywordSummary[word] = {
                                    word: word,
                                    impression: 0,
                                    ctr: 0,
                                    click: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0                                  
                                }
                            }
                            p12PCKeywordSummary[word].impression += keyword[6] ? parseInt(keyword[6]) : 0;
                            p12PCKeywordSummary[word].click += keyword[7] ? parseInt(keyword[7]) : 0;
                            p12PCKeywordSummary[word].spend += keyword[8] ? parseFloat(keyword[8]) / 100 : 0.0;
                            p12PCKeywordSummary[word].order += keyword[19] ? parseInt(keyword[19]) : 0;
                            p12PCKeywordSummary[word].sale += keyword[18] ? parseFloat(keyword[18]) / 100 : 0.0;
                            p12PCKeywordSummary[word].cart += keyword[24] ? parseInt(keyword[24]) : 0;
                            p12PCKeywordSummary[word].fav += keyword[20] ? parseInt(keyword[20]) : 0;
                        }
                    }
                    var p12PCKeywordSummaryArr = [];
                    for (var j in p12PCKeywordSummary) {
                        p12PCKeywordSummary[j].ctr = p12PCKeywordSummary[j].impression > 0 ? p12PCKeywordSummary[j].click / p12PCKeywordSummary[j].impression * 100 : 0;
                        p12PCKeywordSummary[j].cpc = p12PCKeywordSummary[j].click > 0 ? p12PCKeywordSummary[j].spend / p12PCKeywordSummary[j].click : 0;
                        p12PCKeywordSummary[j].roi = p12PCKeywordSummary[j].spend > 0 ? p12PCKeywordSummary[j].sale / p12PCKeywordSummary[j].spend : 0;
                        p12PCKeywordSummary[j].cvr = p12PCKeywordSummary[j].click > 0 ? p12PCKeywordSummary[j].order / p12PCKeywordSummary[j].click * 100 : 0;
                        p12PCKeywordSummary[j].cpu = p12PCKeywordSummary[j].order > 0 ? Math.round(p12PCKeywordSummary[j].spend / p12PCKeywordSummary[j].order) : 0;
                        p12PCKeywordSummaryArr.push(p12PCKeywordSummary[j]);
                    }
                    
                    p12PCKeywordSummaryArr.sort(function(a, b) {
                        return parseInt(b.click) - parseInt(a.click);
                    });
                %>

                <div id="pageHeader-5">
                    <h3>ZTC Performance review by category-EC直通车投放情况分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings: xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-EC日常对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p5NormalTotal.impression %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.click %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p5NormalTotal.spend %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.cpc %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.order %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.sale %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.cart %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.fav %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.roi %></span></td> 
                            <td><span class="number"><%= p5NormalTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p5NormalTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-EC活动对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p5ActivityTotal.impression %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.click %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p5ActivityTotal.spend %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.cpc %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.order %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.sale %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.cart %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.fav %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.roi %></span></td> 
                            <td><span class="number"><%= p5ActivityTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p5ActivityTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-EC品牌保护对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p5ProtectTotal.impression %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.click %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p5ProtectTotal.spend %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.cpc %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.order %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.sale %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.cart %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.fav %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.roi %></span></td> 
                            <td><span class="number"><%= p5ProtectTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p5ProtectTotal.cpu %></span></td>
                        </tr>
                    </table> 
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-6">
                    <h3>ZTC Performance review by category-FC直通车投放情况分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings: xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-FC日常对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p6NormalTotal.impression %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.click %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p6NormalTotal.spend %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.cpc %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.order %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.sale %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.cart %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.fav %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.roi %></span></td> 
                            <td><span class="number"><%= p6NormalTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p6NormalTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-FC活动对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p6ActivityTotal.impression %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.click %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p6ActivityTotal.spend %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.cpc %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.order %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.sale %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.cart %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.fav %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.roi %></span></td> 
                            <td><span class="number"><%= p6ActivityTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p6ActivityTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-FC品牌保护对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p6ProtectTotal.impression %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.click %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p6ProtectTotal.spend %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.cpc %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.order %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.sale %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.cart %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.fav %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.roi %></span></td> 
                            <td><span class="number"><%= p6ProtectTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p6ProtectTotal.cpu %></span></td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-7">
                    <h3>ZTC Performance review by category-PC直通车投放情况分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings: xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-PC整体数据对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p7PCActivityTotal.impression %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.click %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p7PCActivityTotal.spend %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.cpc %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.order %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.sale %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.cart %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.fav %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.roi %></span></td> 
                            <td><span class="number"><%= p7PCActivityTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p7PCActivityTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br /> 
                    <table>
                        <tr class="title">
                            <th colspan="13">ZTC-PC品牌保护对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p7ProtectTotal.impression %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.click %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p7ProtectTotal.spend %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.cpc %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.order %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.sale %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.cart %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.fav %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.roi %></span></td> 
                            <td><span class="number"><%= p7ProtectTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p7ProtectTotal.cpu %></span></td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-8">
                    <h3>ZTC Performance review by category-EC 重点单品直通车投放分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings: xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>节奏</th>
                            <th>ZTC-EC</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p5ActivitySummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= Object.keys(p5ActivitySummary).length + 1 %>">活动</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p5ActivitySummary[i].impression %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].click %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p5ActivitySummary[i].spend %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].order %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].sale %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].cart %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].fav %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].roi %></span></td> 
                                <td><span class="number"><%= p5ActivitySummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p5ActivitySummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="total">
                            <td>总计</td>
                            <td><span class="number"><%= p5ActivityTotal.impression %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.click %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.ctr %></span>%</td>
                            <td><span class="number"><%= p5ActivityTotal.spend %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.cpc %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.order %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.sale %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.cart %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.fav %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.roi %></span></td>
                            <td><span class="number"><%= p5ActivityTotal.cvr %></span>%</td>
                            <td><span class="number"><%= p5ActivityTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>节奏</th>
                            <th>ZTC-EC</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p5NormalSummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= Object.keys(p5NormalSummary).length + 1 %>">日常</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p5NormalSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].click %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p5NormalSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].order %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p5NormalSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p5NormalSummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="total">
                            <td>总计</td>
                            <td><span class="number"><%= p5NormalTotal.impression %></span></td>
                            <td><span class="number"><%= p5NormalTotal.click %></span></td>
                            <td><span class="number"><%= p5NormalTotal.ctr %></span>%</td>
                            <td><span class="number"><%= p5NormalTotal.spend %></span></td>
                            <td><span class="number"><%= p5NormalTotal.cpc %></span></td>
                            <td><span class="number"><%= p5NormalTotal.order %></span></td>
                            <td><span class="number"><%= p5NormalTotal.sale %></span></td>
                            <td><span class="number"><%= p5NormalTotal.cart %></span></td>
                            <td><span class="number"><%= p5NormalTotal.fav %></span></td>
                            <td><span class="number"><%= p5NormalTotal.roi %></span></td>
                            <td><span class="number"><%= p5NormalTotal.cvr %></span>%</td>
                            <td><span class="number"><%= p5NormalTotal.cpu %></span></td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-9">
                    <h3>ZTC Performance review by category-FC 重点单品直通车投放分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings: xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>节奏</th>
                            <th>ZTC-FC</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p6ActivitySummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= Object.keys(p6ActivitySummary).length + 1 %>">活动</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p6ActivitySummary[i].impression %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].click %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p6ActivitySummary[i].spend %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].order %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].sale %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].cart %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].fav %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].roi %></span></td> 
                                <td><span class="number"><%= p6ActivitySummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p6ActivitySummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="total">
                            <td>总计</td>
                            <td><span class="number"><%= p6ActivityTotal.impression %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.click %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.ctr %></span>%</td>
                            <td><span class="number"><%= p6ActivityTotal.spend %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.cpc %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.order %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.sale %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.cart %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.fav %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.roi %></span></td>
                            <td><span class="number"><%= p6ActivityTotal.cvr %></span>%</td>
                            <td><span class="number"><%= p6ActivityTotal.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>节奏</th>
                            <th>ZTC-FC</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var isFirst = false; for (var i in p6NormalSummary) { %>
                            <tr>
                                <% if ( ! isFirst) { isFirst = true; %>
                                    <td rowspan="<%= Object.keys(p6NormalSummary).length + 1 %>">日常</td>
                                <% } %>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p6NormalSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].click %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p6NormalSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].order %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p6NormalSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p6NormalSummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="total">
                            <td>总计</td>
                            <td><span class="number"><%= p6NormalTotal.impression %></span></td>
                            <td><span class="number"><%= p6NormalTotal.click %></span></td>
                            <td><span class="number"><%= p6NormalTotal.ctr %></span>%</td>
                            <td><span class="number"><%= p6NormalTotal.spend %></span></td>
                            <td><span class="number"><%= p6NormalTotal.cpc %></span></td>
                            <td><span class="number"><%= p6NormalTotal.order %></span></td>
                            <td><span class="number"><%= p6NormalTotal.sale %></span></td>
                            <td><span class="number"><%= p6NormalTotal.cart %></span></td>
                            <td><span class="number"><%= p6NormalTotal.fav %></span></td>
                            <td><span class="number"><%= p6NormalTotal.roi %></span></td>
                            <td><span class="number"><%= p6NormalTotal.cvr %></span>%</td>
                            <td><span class="number"><%= p6NormalTotal.cpu %></span></td>
                        </tr>
                    </table>
                </div>
            </div>            

            <div class="page">
                <div id="pageHeader-10">
                    <h3>EC Key words bidding review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>ZTC-EC品牌保护（Top）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% p8ECKeywordSummarySaleCounter = 0; for (var i in p8ECKeywordSummaryArr) { %>
                            <% if (p8ECKeywordSummaryArr[i].sale > 0 && p8ECKeywordSummarySaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p8ECKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>ZTC-EC品牌保护（Bottom）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p8ECKeywordSummaryNoSaleCounter = 0; for (var i in p8ECKeywordSummaryArr) { %>
                            <% if (p8ECKeywordSummaryArr[i].sale === 0 && p8ECKeywordSummaryNoSaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p8ECKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p8ECKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-11">
                    <h3>EC Key words bidding review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>ZTC-EC重点单品（Top）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p9ECKeywordSummarySaleCounter = 0; for (var i in p9ECKeywordSummaryArr) { %>
                            <% if (p9ECKeywordSummaryArr[i].sale > 0 && p9ECKeywordSummarySaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p9ECKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>ZTC-EC重点单品（Bottom）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p9ECKeywordSummaryNoSaleCounter = 0; for (var i in p9ECKeywordSummaryArr) { %>
                            <% if (p9ECKeywordSummaryArr[i].sale === 0 && p9ECKeywordSummaryNoSaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p9ECKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p9ECKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                </div>
            </div>            

            <div class="page">
                <div id="pageHeader-12">
                    <h3>FC Key words bidding review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>ZTC-FC品牌保护（Top）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% p10FCKeywordSummarySaleCounter = 0; for (var i in p10FCKeywordSummaryArr) { %>
                            <% if (p10FCKeywordSummaryArr[i].sale > 0 && p10FCKeywordSummarySaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p10FCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>ZTC-FC品牌保护（Bottom）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p10FCKeywordSummaryNoSaleCounter = 0; for (var i in p10FCKeywordSummaryArr) { %>
                            <% if (p10FCKeywordSummaryArr[i].sale === 0 && p10FCKeywordSummaryNoSaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p10FCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p10FCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-13">
                    <h3>FC Key words bidding review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>ZTC-FC重点单品（Top）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% p11FCKeywordSummarySaleCounter = 0; for (var i in p11FCKeywordSummaryArr) { %>
                            <% if (p11FCKeywordSummaryArr[i].sale > 0 && p11FCKeywordSummarySaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p11FCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>ZTC-FC重点单品（Bottom）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p11FCKeywordSummaryNoSaleCounter = 0; for (var i in p11FCKeywordSummaryArr) { %>
                            <% if (p11FCKeywordSummaryArr[i].sale === 0 && p11FCKeywordSummaryNoSaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p11FCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p11FCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-14">
                    <h3>PC Key words bidding review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>ZTC-PC品牌保护（Top）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% p12PCKeywordSummarySaleCounter = 0; for (var i in p12PCKeywordSummaryArr) { %>
                            <% if (p12PCKeywordSummaryArr[i].sale > 0 && p12PCKeywordSummarySaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p12PCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th>ZTC-PC品牌保护（Bottom）</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% var p12PCKeywordSummaryNoSaleCounter = 0; for (var i in p12PCKeywordSummaryArr) { %>
                            <% if (p12PCKeywordSummaryArr[i].sale === 0 && p12PCKeywordSummaryNoSaleCounter ++ < 5) { %>
                            <tr>
                                <td><%= p12PCKeywordSummaryArr[i].word %></td>  
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].impression %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].click %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].spend %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cpc %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].order %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].sale %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cart %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].fav %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].roi %></span></td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p12PCKeywordSummaryArr[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        <% } %>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-15">
                    <h3>ZTC Creative review & A/B Testing Review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li></li>
                </ul>
                <div>
                    
                </div>
                <div id="pageFooter-12" contenteditable="true">总结：图为示例，详情请见同期创意报告直通车部分。</div>
            </div>

            <div class="page">
                <%
                    var p13ZuanshiECSummary = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p13ZuanshiFCSummary = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    var p13ZuanshiPCSummary = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    for (var i in ecRpt.zuanshi.campaigns) {
                        var campaign = ecRpt.zuanshi.campaigns[i];
                        p13ZuanshiECSummary.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p13ZuanshiECSummary.click += campaign.click ? parseInt(campaign.click) : 0;
                        p13ZuanshiECSummary.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p13ZuanshiECSummary.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p13ZuanshiECSummary.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0.0;
                        p13ZuanshiECSummary.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p13ZuanshiECSummary.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                    }
                    p13ZuanshiECSummary.ctr = p13ZuanshiECSummary.impression > 0 ? p13ZuanshiECSummary.click / p13ZuanshiECSummary.impression * 100 : 0;
                    p13ZuanshiECSummary.cpc = p13ZuanshiECSummary.click > 0 ? p13ZuanshiECSummary.spend / p13ZuanshiECSummary.click : 0;
                    p13ZuanshiECSummary.roi = p13ZuanshiECSummary.spend > 0 ? p13ZuanshiECSummary.sale / p13ZuanshiECSummary.spend : 0;
                    p13ZuanshiECSummary.cvr = p13ZuanshiECSummary.click > 0 ? (p13ZuanshiECSummary.order / p13ZuanshiECSummary.click) * 100 : 0.0;
                    p13ZuanshiECSummary.cpu = p13ZuanshiECSummary.order > 0 ? Math.round(p13ZuanshiECSummary.spend / p13ZuanshiECSummary.order) : 0.0;

                    for (var i in fcRpt.zuanshi.campaigns) {
                        var campaign = fcRpt.zuanshi.campaigns[i];
                        p13ZuanshiFCSummary.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p13ZuanshiFCSummary.click += campaign.click ? parseInt(campaign.click) : 0;
                        p13ZuanshiFCSummary.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p13ZuanshiFCSummary.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p13ZuanshiFCSummary.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0.0;
                        p13ZuanshiFCSummary.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p13ZuanshiFCSummary.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                    }
                    p13ZuanshiFCSummary.ctr = p13ZuanshiFCSummary.impression > 0 ? p13ZuanshiFCSummary.click / p13ZuanshiFCSummary.impression * 100 : 0;
                    p13ZuanshiFCSummary.cpc = p13ZuanshiFCSummary.click > 0 ? p13ZuanshiFCSummary.spend / p13ZuanshiFCSummary.click : 0;
                    p13ZuanshiFCSummary.roi = p13ZuanshiFCSummary.spend > 0 ? p13ZuanshiFCSummary.sale / p13ZuanshiFCSummary.spend : 0;
                    p13ZuanshiFCSummary.cvr = p13ZuanshiFCSummary.click > 0 ? (p13ZuanshiFCSummary.order / p13ZuanshiFCSummary.click) * 100 : 0.0;
                    p13ZuanshiFCSummary.cpu = p13ZuanshiFCSummary.order > 0 ? Math.round(p13ZuanshiFCSummary.spend / p13ZuanshiFCSummary.order) : 0.0;

                    for (var i in pcRpt.zuanshi.campaigns) {
                        var campaign = pcRpt.zuanshi.campaigns[i];
                        p13ZuanshiPCSummary.impression += campaign.adPv ? parseInt(campaign.adPv) : 0;
                        p13ZuanshiPCSummary.click += campaign.click ? parseInt(campaign.click) : 0;
                        p13ZuanshiPCSummary.spend += campaign.charge ? parseFloat(campaign.charge) : 0.0;
                        p13ZuanshiPCSummary.order += campaign.alipayInShopNum ? parseInt(campaign.alipayInShopNum) : 0;
                        p13ZuanshiPCSummary.sale += campaign.alipayInshopAmt ? parseFloat(campaign.alipayInshopAmt) : 0.0;
                        p13ZuanshiPCSummary.cart += campaign.cartNum ? parseInt(campaign.cartNum) : 0;
                        p13ZuanshiPCSummary.fav += campaign.inshopItemColNum ? parseInt(campaign.inshopItemColNum) : 0;
                    }
                    p13ZuanshiPCSummary.ctr = p13ZuanshiPCSummary.impression > 0 ? p13ZuanshiPCSummary.click / p13ZuanshiPCSummary.impression * 100 : 0;
                    p13ZuanshiPCSummary.cpc = p13ZuanshiPCSummary.click > 0 ? p13ZuanshiPCSummary.spend / p13ZuanshiPCSummary.click : 0;
                    p13ZuanshiPCSummary.roi = p13ZuanshiPCSummary.spend > 0 ? p13ZuanshiPCSummary.sale / p13ZuanshiPCSummary.spend : 0;
                    p13ZuanshiPCSummary.cvr = p13ZuanshiPCSummary.click > 0 ? (p13ZuanshiPCSummary.order / p13ZuanshiPCSummary.click) * 100 : 0.0;
                    p13ZuanshiPCSummary.cpu = p13ZuanshiPCSummary.order > 0 ? Math.round(p13ZuanshiPCSummary.spend / p13ZuanshiPCSummary.order) : 0.0;
                %>
                <div id="pageHeader-16">
                    <h3>Diamond Display review by category-钻展各大品类投放周分析</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th colspan="13">EC数据对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>
                            <td><span class="number"><%= p13ZuanshiECSummary.impression %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.click %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.ctr %></span>%</td>
                            <td><span class="number"><%= p13ZuanshiECSummary.spend %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.cpc %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.order %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.sale %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.cart %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.fav %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.roi %></span></td>
                            <td><span class="number"><%= p13ZuanshiECSummary.cvr %></span>%</td>
                            <td><span class="number"><%= p13ZuanshiECSummary.cpu %></span></td>
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">FC数据对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>  
                            <td><span class="number"><%= p13ZuanshiFCSummary.impression %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.click %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.ctr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.spend %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cpc %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.order %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.sale %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cart %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.fav %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.roi %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cvr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cpu %></span></td> 
                        </tr>
                    </table>
                    <br />
                    <table>
                        <tr class="title">
                            <th colspan="13">PC数据对比</th>
                        </tr>
                        <tr class="title">
                            <th>Date</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>本周</td>  
                            <td><span class="number"><%= p13ZuanshiPCSummary.impression %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.click %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.ctr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.spend %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cpc %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.order %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.sale %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cart %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.fav %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.roi %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cvr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cpu %></span></td>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <%
                    var p3ZuanshiSummaryTotal = {
                        impression: 0,
                        click: 0,
                        ctr: 0,
                        spend: 0,
                        cpc: 0,
                        order: 0,
                        sale: 0,
                        cart: 0,
                        fav: 0,
                        roi: 0,
                        cvr: 0,
                        cpu: 0
                    };
                    for (var i in p3ZuanshiSummary) {
                        p3ZuanshiSummaryTotal.impression += p3ZuanshiSummary[i].impression;
                        p3ZuanshiSummaryTotal.click += p3ZuanshiSummary[i].click;
                        p3ZuanshiSummaryTotal.spend += p3ZuanshiSummary[i].spend;
                        p3ZuanshiSummaryTotal.order += p3ZuanshiSummary[i].order;
                        p3ZuanshiSummaryTotal.sale += p3ZuanshiSummary[i].sale;
                        p3ZuanshiSummaryTotal.cart += p3ZuanshiSummary[i].cart;
                        p3ZuanshiSummaryTotal.fav += p3ZuanshiSummary[i].fav;
                    }
                    p3ZuanshiSummaryTotal.ctr = p3ZuanshiSummaryTotal.impression > 0 ? p3ZuanshiSummaryTotal.click / p3ZuanshiSummaryTotal.impression * 100 : 0;
                    p3ZuanshiSummaryTotal.cpc = p3ZuanshiSummaryTotal.click > 0 ? p3ZuanshiSummaryTotal.spend / p3ZuanshiSummaryTotal.click : 0;
                    p3ZuanshiSummaryTotal.roi = p3ZuanshiSummaryTotal.spend > 0 ? p3ZuanshiSummaryTotal.sale / p3ZuanshiSummaryTotal.spend : 0;
                    p3ZuanshiSummaryTotal.cvr = p3ZuanshiSummaryTotal.click > 0 ? (p3ZuanshiSummaryTotal.order / p3ZuanshiSummaryTotal.click) * 100 : 0.0;
                    p3ZuanshiSummaryTotal.cpu = p3ZuanshiSummaryTotal.order > 0 ? Math.round(p3ZuanshiSummaryTotal.spend / p3ZuanshiSummaryTotal.order) : 0.0;
                %>
                <div id="pageHeader-17">
                    <h3>Diamond Display 各子分类数据</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>DD-子分类</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <% for (var i in p3ZuanshiSummary) { %>
                            <tr>
                                <td><%= i %></td>  
                                <td><span class="number"><%= p3ZuanshiSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].click %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].order %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p3ZuanshiSummary[i].cpu %></span></td> 
                            </tr>
                        <% } %>
                        <tr class="total">
                            <td>总计</td>  
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.impression %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.click %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.ctr %></span>%</td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.spend %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.cpc %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.order %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.sale %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.cart %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.fav %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.roi %></span></td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.cvr %></span>%</td> 
                            <td><span class="number"><%= p3ZuanshiSummaryTotal.cpu %></span></td> 
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <%
                    var p15ZuanshiECCrowdSummary = {
                        'interest': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0,
                        },
                        'self': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'trade': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'action': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        }
                    };
                    for (var i in ecRpt.zuanshi.campaigns) {
                        var campaign = ecRpt.zuanshi.campaigns[i];
                        if (campaign.campaignName.indexOf('兴趣') > -1) {
                            p15ZuanshiECCrowdSummary['interest'].impression += parseInt(campaign.adPv);
                            p15ZuanshiECCrowdSummary['interest'].click += parseInt(campaign.click);
                            p15ZuanshiECCrowdSummary['interest'].spend += parseFloat(campaign.charge);
                            p15ZuanshiECCrowdSummary['interest'].order += parseInt(campaign.alipayInShopNum);
                            p15ZuanshiECCrowdSummary['interest'].sale += parseFloat(campaign.alipayInshopAmt);
                            p15ZuanshiECCrowdSummary['interest'].cart += parseInt(campaign.cartNum);
                            p15ZuanshiECCrowdSummary['interest'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('自主') > -1) {
                            p15ZuanshiECCrowdSummary['self'].impression += parseInt(campaign.adPv);
                            p15ZuanshiECCrowdSummary['self'].click += parseInt(campaign.click);
                            p15ZuanshiECCrowdSummary['self'].spend += parseFloat(campaign.charge);
                            p15ZuanshiECCrowdSummary['self'].order += parseInt(campaign.alipayInShopNum);
                            p15ZuanshiECCrowdSummary['self'].sale += parseFloat(campaign.alipayInshopAmt);
                            p15ZuanshiECCrowdSummary['self'].cart += parseFloat(campaign.cartNum);
                            p15ZuanshiECCrowdSummary['self'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('成交') > -1) {
                            p15ZuanshiECCrowdSummary['trade'].impression += parseInt(campaign.adPv);
                            p15ZuanshiECCrowdSummary['trade'].click += parseInt(campaign.click);
                            p15ZuanshiECCrowdSummary['trade'].spend += parseFloat(campaign.charge);
                            p15ZuanshiECCrowdSummary['trade'].order += parseInt(campaign.alipayInShopNum);
                            p15ZuanshiECCrowdSummary['trade'].sale += parseFloat(campaign.alipayInshopAmt);
                            p15ZuanshiECCrowdSummary['trade'].cart += parseFloat(campaign.cartNum);
                            p15ZuanshiECCrowdSummary['trade'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('行动意向') > -1) {
                            p15ZuanshiECCrowdSummary['action'].impression += parseInt(campaign.adPv);
                            p15ZuanshiECCrowdSummary['action'].click += parseInt(campaign.click);
                            p15ZuanshiECCrowdSummary['action'].spend += parseFloat(campaign.charge);
                            p15ZuanshiECCrowdSummary['action'].order += parseInt(campaign.alipayInShopNum);
                            p15ZuanshiECCrowdSummary['action'].sale += parseFloat(campaign.alipayInshopAmt);
                            p15ZuanshiECCrowdSummary['action'].cart += parseFloat(campaign.cartNum);
                            p15ZuanshiECCrowdSummary['action'].fav += parseInt(campaign.inshopItemColNum);
                        }
                        p15ZuanshiECCrowdSummary['interest'].ctr = p15ZuanshiECCrowdSummary['interest'].impression > 0 ? p15ZuanshiECCrowdSummary['interest'].click / p15ZuanshiECCrowdSummary['interest'].impression * 100 : 0;
                        p15ZuanshiECCrowdSummary['interest'].cpc = p15ZuanshiECCrowdSummary['interest'].click > 0 ? p15ZuanshiECCrowdSummary['interest'].spend / p15ZuanshiECCrowdSummary['interest'].click : 0;
                        p15ZuanshiECCrowdSummary['interest'].roi = p15ZuanshiECCrowdSummary['interest'].spend > 0 ? p15ZuanshiECCrowdSummary['interest'].sale / p15ZuanshiECCrowdSummary['interest'].spend : 0;
                        p15ZuanshiECCrowdSummary['interest'].cvr = p15ZuanshiECCrowdSummary['interest'].click > 0 ? (p15ZuanshiECCrowdSummary['interest'].order / p15ZuanshiECCrowdSummary['interest'].click) * 100 : 0.0;
                        p15ZuanshiECCrowdSummary['interest'].cpu = p15ZuanshiECCrowdSummary['interest'].order > 0 ? Math.round(p15ZuanshiECCrowdSummary['interest'].spend / p15ZuanshiECCrowdSummary['interest'].order) : 0.0;
                        p15ZuanshiECCrowdSummary['self'].ctr = p15ZuanshiECCrowdSummary['self'].impression > 0 ? p15ZuanshiECCrowdSummary['self'].click / p15ZuanshiECCrowdSummary['self'].impression * 100 : 0;
                        p15ZuanshiECCrowdSummary['self'].cpc = p15ZuanshiECCrowdSummary['self'].click > 0 ? p15ZuanshiECCrowdSummary['self'].spend / p15ZuanshiECCrowdSummary['self'].click : 0;
                        p15ZuanshiECCrowdSummary['self'].roi = p15ZuanshiECCrowdSummary['self'].spend > 0 ? p15ZuanshiECCrowdSummary['self'].sale / p15ZuanshiECCrowdSummary['self'].spend : 0;
                        p15ZuanshiECCrowdSummary['self'].cvr = p15ZuanshiECCrowdSummary['self'].click > 0 ? (p15ZuanshiECCrowdSummary['self'].order / p15ZuanshiECCrowdSummary['self'].click) * 100 : 0.0;
                        p15ZuanshiECCrowdSummary['self'].cpu = p15ZuanshiECCrowdSummary['self'].order > 0 ? Math.round(p15ZuanshiECCrowdSummary['self'].spend / p15ZuanshiECCrowdSummary['self'].order) : 0.0;
                        p15ZuanshiECCrowdSummary['trade'].ctr = p15ZuanshiECCrowdSummary['trade'].impression > 0 ? p15ZuanshiECCrowdSummary['trade'].click / p15ZuanshiECCrowdSummary['trade'].impression * 100 : 0;
                        p15ZuanshiECCrowdSummary['trade'].cpc = p15ZuanshiECCrowdSummary['trade'].click > 0 ? p15ZuanshiECCrowdSummary['trade'].spend / p15ZuanshiECCrowdSummary['trade'].click : 0;
                        p15ZuanshiECCrowdSummary['trade'].roi = p15ZuanshiECCrowdSummary['trade'].spend > 0 ? p15ZuanshiECCrowdSummary['trade'].sale / p15ZuanshiECCrowdSummary['trade'].spend : 0;
                        p15ZuanshiECCrowdSummary['trade'].cvr = p15ZuanshiECCrowdSummary['trade'].click > 0 ? (p15ZuanshiECCrowdSummary['trade'].order / p15ZuanshiECCrowdSummary['trade'].click) * 100 : 0.0;
                        p15ZuanshiECCrowdSummary['trade'].cpu = p15ZuanshiECCrowdSummary['trade'].order > 0 ? Math.round(p15ZuanshiECCrowdSummary['trade'].spend / p15ZuanshiECCrowdSummary['trade'].order) : 0.0;
                        p15ZuanshiECCrowdSummary['action'].ctr = p15ZuanshiECCrowdSummary['action'].impression > 0 ? p15ZuanshiECCrowdSummary['action'].click / p15ZuanshiECCrowdSummary['action'].impression * 100 : 0;
                        p15ZuanshiECCrowdSummary['action'].cpc = p15ZuanshiECCrowdSummary['action'].click > 0 ? p15ZuanshiECCrowdSummary['action'].spend / p15ZuanshiECCrowdSummary['action'].click : 0;
                        p15ZuanshiECCrowdSummary['action'].roi = p15ZuanshiECCrowdSummary['action'].spend > 0 ? p15ZuanshiECCrowdSummary['action'].sale / p15ZuanshiECCrowdSummary['action'].spend : 0;
                        p15ZuanshiECCrowdSummary['action'].cvr = p15ZuanshiECCrowdSummary['action'].click > 0 ? (p15ZuanshiECCrowdSummary['action'].order / p15ZuanshiECCrowdSummary['action'].click) * 100 : 0.0;
                        p15ZuanshiECCrowdSummary['action'].cpu = p15ZuanshiECCrowdSummary['action'].order > 0 ? Math.round(p15ZuanshiECCrowdSummary['action'].spend / p15ZuanshiECCrowdSummary['action'].order) : 0.0;
                    }

                    var p15ZuanshiECDMPInterestSummary = {};
                    for (var i in ecRpt.zuanshi.targets) {
                        var target = ecRpt.zuanshi.targets[i];
                        if (target.campaignName.indexOf('兴') > -1) {
                            var tName = target.targetName.replace(/.+?:(.+?)/, '$1');
                            if ( ! p15ZuanshiECDMPInterestSummary[tName]) {
                                p15ZuanshiECDMPInterestSummary[tName] = {
                                    impression: 0,
                                    click: 0,
                                    ctr: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0
                                };
                            }
                            p15ZuanshiECDMPInterestSummary[tName].impression += parseInt(target.adPv);
                            p15ZuanshiECDMPInterestSummary[tName].click += parseInt(target.click);
                            p15ZuanshiECDMPInterestSummary[tName].spend += parseFloat(target.charge);
                            p15ZuanshiECDMPInterestSummary[tName].order += parseInt(target.alipayInShopNum);
                            p15ZuanshiECDMPInterestSummary[tName].sale += parseFloat(target.alipayInshopAmt);
                            p15ZuanshiECDMPInterestSummary[tName].cart += parseFloat(target.cartNum);
                            p15ZuanshiECDMPInterestSummary[tName].fav += parseFloat(target.inshopItemColNum);
                        }
                    }
                    
                    for (var i in p15ZuanshiECDMPInterestSummary) {
                        p15ZuanshiECDMPInterestSummary[i].ctr = p15ZuanshiECDMPInterestSummary[i].impression > 0 ? p15ZuanshiECDMPInterestSummary[i].click / p15ZuanshiECDMPInterestSummary[i].impression * 100 : 0;
                        p15ZuanshiECDMPInterestSummary[i].cpc = p15ZuanshiECDMPInterestSummary[i].click > 0 ? p15ZuanshiECDMPInterestSummary[i].spend / p15ZuanshiECDMPInterestSummary[i].click : 0;
                        p15ZuanshiECDMPInterestSummary[i].roi = p15ZuanshiECDMPInterestSummary[i].spend > 0 ? p15ZuanshiECDMPInterestSummary[i].sale / p15ZuanshiECDMPInterestSummary[i].spend : 0;
                        p15ZuanshiECDMPInterestSummary[i].cvr = p15ZuanshiECDMPInterestSummary[i].click > 0 ? (p15ZuanshiECDMPInterestSummary[i].order / p15ZuanshiECDMPInterestSummary[i].click) * 100 : 0.0;
                        p15ZuanshiECDMPInterestSummary[i].cpu = p15ZuanshiECDMPInterestSummary[i].order > 0 ? Math.round(p15ZuanshiECDMPInterestSummary[i].spend / p15ZuanshiECDMPInterestSummary[i].order) : 0.0;
                    }
                %>
                <div id="pageHeader-18">
                    <h3>EC Diamond Display review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>DD-EC人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>兴趣</td>  
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].impression %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].click %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].ctr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].spend %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].cpc %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].order %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].sale %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].cart %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].fav %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].roi %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].cvr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['interest'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>竞品店铺</td>  
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].impression %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].click %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].ctr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].spend %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].cpc %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].order %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].sale %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].cart %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].fav %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].roi %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].cvr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['self'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>成交</td>  
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].impression %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].click %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].ctr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].spend %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].cpc %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].order %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].sale %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].cart %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].fav %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].roi %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].cvr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['trade'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>行动意向</td>  
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].impression %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].click %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].ctr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].spend %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].cpc %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].order %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].sale %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].cart %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].fav %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].roi %></span></td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].cvr %></span>%</td> 
                            <td><span class="number"><%= p15ZuanshiECCrowdSummary['action'].cpu %></span></td> 
                        </tr>
                        <tr class="total">
                            <td>EC</td>  
                            <td><span class="number"><%= p13ZuanshiECSummary.impression %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.click %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.ctr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.spend %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.cpc %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.order %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.sale %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.cart %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.fav %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.roi %></span></td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.cvr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiECSummary.cpu %></span></td> 
                        </tr>
                    </table>
                    <br />
                    <table class="small">
                        <tr class="title">
                            <th>DD-EC兴趣人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <% for (var i in p15ZuanshiECDMPInterestSummary) { %>
                            <tr>
                                <td><%= i %></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].click %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].order %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p15ZuanshiECDMPInterestSummary[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <%
                    var p18ZuanshiFCCrowdSummary = {
                        'interest': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'competitor': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'action': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'sale': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        }
                    };
                    for (var i in fcRpt.zuanshi.campaigns) {
                        var campaign = fcRpt.zuanshi.campaigns[i];
                        if (campaign.campaignName.indexOf('兴趣') > -1) {
                            p18ZuanshiFCCrowdSummary['interest'].impression += parseInt(campaign.adPv);
                            p18ZuanshiFCCrowdSummary['interest'].click += parseInt(campaign.click);
                            p18ZuanshiFCCrowdSummary['interest'].spend += parseFloat(campaign.charge);
                            p18ZuanshiFCCrowdSummary['interest'].order += parseInt(campaign.alipayInShopNum);
                            p18ZuanshiFCCrowdSummary['interest'].sale += parseFloat(campaign.alipayInshopAmt);
                            p18ZuanshiFCCrowdSummary['interest'].cart += parseInt(campaign.cartNum);
                            p18ZuanshiFCCrowdSummary['interest'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('成交') > -1) {
                            p18ZuanshiFCCrowdSummary['sale'].impression += parseInt(campaign.adPv);
                            p18ZuanshiFCCrowdSummary['sale'].click += parseInt(campaign.click);
                            p18ZuanshiFCCrowdSummary['sale'].spend += parseFloat(campaign.charge);
                            p18ZuanshiFCCrowdSummary['sale'].order += parseInt(campaign.alipayInShopNum);
                            p18ZuanshiFCCrowdSummary['sale'].sale += parseFloat(campaign.alipayInshopAmt);
                            p18ZuanshiFCCrowdSummary['sale'].cart += parseInt(campaign.cartNum);
                            p18ZuanshiFCCrowdSummary['sale'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('行动意向') > -1) {
                            p18ZuanshiFCCrowdSummary['action'].impression += parseInt(campaign.adPv);
                            p18ZuanshiFCCrowdSummary['action'].click += parseInt(campaign.click);
                            p18ZuanshiFCCrowdSummary['action'].spend += parseFloat(campaign.charge);
                            p18ZuanshiFCCrowdSummary['action'].order += parseInt(campaign.alipayInShopNum);
                            p18ZuanshiFCCrowdSummary['action'].sale += parseFloat(campaign.alipayInshopAmt);
                            p18ZuanshiFCCrowdSummary['action'].cart += parseInt(campaign.cartNum);
                            p18ZuanshiFCCrowdSummary['action'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('自主') > -1) {
                            p18ZuanshiFCCrowdSummary['competitor'].impression += parseInt(campaign.adPv);
                            p18ZuanshiFCCrowdSummary['competitor'].click += parseInt(campaign.click);
                            p18ZuanshiFCCrowdSummary['competitor'].spend += parseFloat(campaign.charge);
                            p18ZuanshiFCCrowdSummary['competitor'].order += parseInt(campaign.alipayInShopNum);
                            p18ZuanshiFCCrowdSummary['competitor'].sale += parseFloat(campaign.alipayInshopAmt);
                            p18ZuanshiFCCrowdSummary['competitor'].cart += parseInt(campaign.cartNum);
                            p18ZuanshiFCCrowdSummary['competitor'].fav += parseInt(campaign.inshopItemColNum);
                        }
                        p18ZuanshiFCCrowdSummary['interest'].cpc = p18ZuanshiFCCrowdSummary['interest'].click > 0 ? p18ZuanshiFCCrowdSummary['interest'].spend / p18ZuanshiFCCrowdSummary['interest'].click : 0;
                        p18ZuanshiFCCrowdSummary['interest'].ctr = p18ZuanshiFCCrowdSummary['interest'].impression > 0 ? p18ZuanshiFCCrowdSummary['interest'].click / p18ZuanshiFCCrowdSummary['interest'].impression * 100 : 0;
                        p18ZuanshiFCCrowdSummary['interest'].roi = p18ZuanshiFCCrowdSummary['interest'].spend > 0 ? p18ZuanshiFCCrowdSummary['interest'].sale / p18ZuanshiFCCrowdSummary['interest'].spend : 0;
                        p18ZuanshiFCCrowdSummary['interest'].cvr = p18ZuanshiFCCrowdSummary['interest'].click > 0 ? (p18ZuanshiFCCrowdSummary['interest'].order / p18ZuanshiFCCrowdSummary['interest'].click) * 100 : 0.0;
                        p18ZuanshiFCCrowdSummary['interest'].cpu = p18ZuanshiFCCrowdSummary['interest'].order > 0 ? Math.round(p18ZuanshiFCCrowdSummary['interest'].spend / p18ZuanshiFCCrowdSummary['interest'].order) : 0.0;
                        p18ZuanshiFCCrowdSummary['sale'].cpc = p18ZuanshiFCCrowdSummary['sale'].click > 0 ? p18ZuanshiFCCrowdSummary['sale'].spend / p18ZuanshiFCCrowdSummary['sale'].click : 0;
                        p18ZuanshiFCCrowdSummary['sale'].ctr = p18ZuanshiFCCrowdSummary['sale'].impression > 0 ? p18ZuanshiFCCrowdSummary['sale'].click / p18ZuanshiFCCrowdSummary['sale'].impression * 100 : 0;
                        p18ZuanshiFCCrowdSummary['sale'].roi = p18ZuanshiFCCrowdSummary['sale'].spend > 0 ? p18ZuanshiFCCrowdSummary['sale'].sale / p18ZuanshiFCCrowdSummary['sale'].spend : 0;
                        p18ZuanshiFCCrowdSummary['sale'].cvr = p18ZuanshiFCCrowdSummary['sale'].click > 0 ? (p18ZuanshiFCCrowdSummary['sale'].order / p18ZuanshiFCCrowdSummary['sale'].click) * 100 : 0.0;
                        p18ZuanshiFCCrowdSummary['sale'].cpu = p18ZuanshiFCCrowdSummary['sale'].order > 0 ? Math.round(p18ZuanshiFCCrowdSummary['sale'].spend / p18ZuanshiFCCrowdSummary['sale'].order) : 0.0;
                        p18ZuanshiFCCrowdSummary['action'].cpc = p18ZuanshiFCCrowdSummary['action'].click > 0 ? p18ZuanshiFCCrowdSummary['action'].spend / p18ZuanshiFCCrowdSummary['action'].click : 0;
                        p18ZuanshiFCCrowdSummary['action'].ctr = p18ZuanshiFCCrowdSummary['action'].impression > 0 ? p18ZuanshiFCCrowdSummary['action'].click / p18ZuanshiFCCrowdSummary['action'].impression * 100 : 0;
                        p18ZuanshiFCCrowdSummary['action'].roi = p18ZuanshiFCCrowdSummary['action'].spend > 0 ? p18ZuanshiFCCrowdSummary['action'].sale / p18ZuanshiFCCrowdSummary['action'].spend : 0;
                        p18ZuanshiFCCrowdSummary['action'].cvr = p18ZuanshiFCCrowdSummary['action'].click > 0 ? (p18ZuanshiFCCrowdSummary['action'].order / p18ZuanshiFCCrowdSummary['action'].click) * 100 : 0.0;
                        p18ZuanshiFCCrowdSummary['action'].cpu = p18ZuanshiFCCrowdSummary['action'].order > 0 ? Math.round(p18ZuanshiFCCrowdSummary['action'].spend / p18ZuanshiFCCrowdSummary['action'].order) : 0.0;
                        p18ZuanshiFCCrowdSummary['competitor'].cpc = p18ZuanshiFCCrowdSummary['competitor'].click > 0 ? p18ZuanshiFCCrowdSummary['competitor'].spend / p18ZuanshiFCCrowdSummary['competitor'].click : 0;
                        p18ZuanshiFCCrowdSummary['competitor'].ctr = p18ZuanshiFCCrowdSummary['competitor'].impression > 0 ? p18ZuanshiFCCrowdSummary['competitor'].click / p18ZuanshiFCCrowdSummary['competitor'].impression * 100 : 0;
                        p18ZuanshiFCCrowdSummary['competitor'].roi = p18ZuanshiFCCrowdSummary['competitor'].spend > 0 ? p18ZuanshiFCCrowdSummary['competitor'].sale / p18ZuanshiFCCrowdSummary['competitor'].spend : 0;
                        p18ZuanshiFCCrowdSummary['competitor'].cvr = p18ZuanshiFCCrowdSummary['competitor'].click > 0 ? (p18ZuanshiFCCrowdSummary['competitor'].order / p18ZuanshiFCCrowdSummary['competitor'].click) * 100 : 0.0;
                        p18ZuanshiFCCrowdSummary['competitor'].cpu = p18ZuanshiFCCrowdSummary['competitor'].order > 0 ? Math.round(p18ZuanshiFCCrowdSummary['competitor'].spend / p18ZuanshiFCCrowdSummary['competitor'].order) : 0.0;
                    }

                    var p18ZuanshiFCDMPInterestSummary = {};
                    for (var i in fcRpt.zuanshi.targets) {
                        var target = fcRpt.zuanshi.targets[i];
                        if (target.campaignName.indexOf('FC') > -1 && target.targetName.indexOf('兴') > -1) {
                            var tName = target.targetName.replace(/.+?:(.+?)/, '$1');
                            if ( ! p18ZuanshiFCDMPInterestSummary[tName]) {
                                p18ZuanshiFCDMPInterestSummary[tName] = {
                                    impression: 0,
                                    click: 0,
                                    ctr: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0
                                };
                            }
                            p18ZuanshiFCDMPInterestSummary[tName].impression += parseInt(target.adPv);
                            p18ZuanshiFCDMPInterestSummary[tName].click += parseInt(target.click);
                            p18ZuanshiFCDMPInterestSummary[tName].spend += parseFloat(target.charge);
                            p18ZuanshiFCDMPInterestSummary[tName].order += parseInt(target.alipayInShopNum);
                            p18ZuanshiFCDMPInterestSummary[tName].sale += parseFloat(target.alipayInshopAmt);
                            p18ZuanshiFCDMPInterestSummary[tName].cart += parseFloat(target.cartNum);
                            p18ZuanshiFCDMPInterestSummary[tName].fav += parseFloat(target.inshopItemColNum);
                        }
                    }
                    
                    for (var i in p18ZuanshiFCDMPInterestSummary) {
                        p18ZuanshiFCDMPInterestSummary[i].cpc = p18ZuanshiFCDMPInterestSummary[i].click > 0 ? p18ZuanshiFCDMPInterestSummary[i].spend / p18ZuanshiFCDMPInterestSummary[i].click : 0;
                        p18ZuanshiFCDMPInterestSummary[i].ctr = p18ZuanshiFCDMPInterestSummary[i].impression > 0 ? p18ZuanshiFCDMPInterestSummary[i].click / p18ZuanshiFCDMPInterestSummary[i].impression * 100 : 0;
                        p18ZuanshiFCDMPInterestSummary[i].roi = p18ZuanshiFCDMPInterestSummary[i].spend > 0 ? p18ZuanshiFCDMPInterestSummary[i].sale / p18ZuanshiFCDMPInterestSummary[i].spend : 0;
                        p18ZuanshiFCDMPInterestSummary[i].cvr = p18ZuanshiFCDMPInterestSummary[i].click > 0 ? (p18ZuanshiFCDMPInterestSummary[i].order / p18ZuanshiFCDMPInterestSummary[i].click) * 100 : 0.0;
                        p18ZuanshiFCDMPInterestSummary[i].cpu = p18ZuanshiFCDMPInterestSummary[i].order > 0 ? Math.round(p18ZuanshiFCDMPInterestSummary[i].spend / p18ZuanshiFCDMPInterestSummary[i].order) : 0.0;
                    }
                %>
                <div id="pageHeader-19">
                    <h3>FC Diamond Display review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>DD-FC人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>兴趣</td>  
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].impression %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].click %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].ctr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].spend %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].cpc %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].order %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].sale %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].cart %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].fav %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].roi %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].cvr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['interest'].cpu %></span></td>
                        </tr>
                        <tr>
                            <td>成交</td>  
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].impression %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].click %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].ctr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].spend %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].cpc %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].order %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].sale %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].cart %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].fav %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].roi %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].cvr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['sale'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>行动意向</td>  
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].impression %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].click %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].ctr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].spend %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].cpc %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].order %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].sale %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].cart %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].fav %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].roi %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].cvr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['action'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>竞品店铺</td>  
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].impression %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].click %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].ctr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].spend %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].cpc %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].order %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].sale %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].cart %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].fav %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].roi %></span></td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].cvr %></span>%</td> 
                            <td><span class="number"><%= p18ZuanshiFCCrowdSummary['competitor'].cpu %></span></td> 
                        </tr>
                        <tr class="total">
                            <td>FC</td>  
                            <td><span class="number"><%= p13ZuanshiFCSummary.impression %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.click %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.ctr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.spend %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cpc %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.order %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.sale %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cart %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.fav %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.roi %></span></td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cvr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiFCSummary.cpu %></span></td> 
                        </tr>
                    </table>
                    <br />
                    <table class="small">
                        <tr class="title">
                            <th>DD-FC兴趣人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <% for (var i in p18ZuanshiFCDMPInterestSummary) { %>
                            <tr>
                                <td><%= i %></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].click %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].order %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p18ZuanshiFCDMPInterestSummary[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <%
                    var p21ZuanshiPCCrowdSummary = {
                        'interest': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        },
                        'action': {
                            impression: 0,
                            click: 0,
                            ctr: 0,
                            spend: 0,
                            cpc: 0,
                            order: 0,
                            sale: 0,
                            cart: 0,
                            fav: 0,
                            roi: 0,
                            cvr: 0,
                            cpu: 0
                        }
                    };
                    for (var i in pcRpt.zuanshi.campaigns) {
                        var campaign = pcRpt.zuanshi.campaigns[i];
                        if (campaign.campaignName.indexOf('兴趣') > -1) {
                            p21ZuanshiPCCrowdSummary['interest'].impression += parseInt(campaign.adPv);
                            p21ZuanshiPCCrowdSummary['interest'].click += parseInt(campaign.click);
                            p21ZuanshiPCCrowdSummary['interest'].spend += parseFloat(campaign.charge);
                            p21ZuanshiPCCrowdSummary['interest'].order += parseInt(campaign.alipayInShopNum);
                            p21ZuanshiPCCrowdSummary['interest'].sale += parseFloat(campaign.alipayInshopAmt);
                            p21ZuanshiPCCrowdSummary['interest'].cart += parseInt(campaign.cartNum);
                            p21ZuanshiPCCrowdSummary['interest'].fav += parseInt(campaign.inshopItemColNum);
                        } else if (campaign.campaignName.indexOf('行动意向') > -1) {
                            p21ZuanshiPCCrowdSummary['action'].impression += parseInt(campaign.adPv);
                            p21ZuanshiPCCrowdSummary['action'].click += parseInt(campaign.click);
                            p21ZuanshiPCCrowdSummary['action'].spend += parseFloat(campaign.charge);
                            p21ZuanshiPCCrowdSummary['action'].order += parseInt(campaign.alipayInShopNum);
                            p21ZuanshiPCCrowdSummary['action'].sale += parseInt(campaign.alipayInshopAmt);
                            p21ZuanshiPCCrowdSummary['action'].cart += parseInt(campaign.cartNum);
                            p21ZuanshiPCCrowdSummary['action'].fav += parseInt(campaign.inshopItemColNum);
                        }
                        p21ZuanshiPCCrowdSummary['interest'].cpc = p21ZuanshiPCCrowdSummary['interest'].click > 0 ? p21ZuanshiPCCrowdSummary['interest'].spend / p21ZuanshiPCCrowdSummary['interest'].click : 0;
                        p21ZuanshiPCCrowdSummary['interest'].ctr = p21ZuanshiPCCrowdSummary['interest'].impression > 0 ? p21ZuanshiPCCrowdSummary['interest'].click / p21ZuanshiPCCrowdSummary['interest'].impression * 100 : 0;
                        p21ZuanshiPCCrowdSummary['interest'].roi = p21ZuanshiPCCrowdSummary['interest'].spend > 0 ? p21ZuanshiPCCrowdSummary['interest'].sale / p21ZuanshiPCCrowdSummary['interest'].spend : 0;
                        p21ZuanshiPCCrowdSummary['interest'].cvr = p21ZuanshiPCCrowdSummary['interest'].click > 0 ? (p21ZuanshiPCCrowdSummary['interest'].order / p21ZuanshiPCCrowdSummary['interest'].click) * 100 : 0.0;
                        p21ZuanshiPCCrowdSummary['interest'].cpu = p21ZuanshiPCCrowdSummary['interest'].order > 0 ? Math.round(p21ZuanshiPCCrowdSummary['interest'].spend / p21ZuanshiPCCrowdSummary['interest'].order) : 0.0;
                        p21ZuanshiPCCrowdSummary['action'].cpc = p21ZuanshiPCCrowdSummary['action'].click > 0 ? p21ZuanshiPCCrowdSummary['action'].spend / p21ZuanshiPCCrowdSummary['action'].click : 0;
                        p21ZuanshiPCCrowdSummary['action'].ctr = p21ZuanshiPCCrowdSummary['action'].impression > 0 ? p21ZuanshiPCCrowdSummary['action'].click / p21ZuanshiPCCrowdSummary['action'].impression * 100 : 0;
                        p21ZuanshiPCCrowdSummary['action'].roi = p21ZuanshiPCCrowdSummary['action'].spend > 0 ? p21ZuanshiPCCrowdSummary['action'].sale / p21ZuanshiPCCrowdSummary['action'].spend : 0;
                        p21ZuanshiPCCrowdSummary['action'].cvr = p21ZuanshiPCCrowdSummary['action'].click > 0 ? (p21ZuanshiPCCrowdSummary['action'].order / p21ZuanshiPCCrowdSummary['action'].click) * 100 : 0.0;
                        p21ZuanshiPCCrowdSummary['action'].cpu = p21ZuanshiPCCrowdSummary['action'].order > 0 ? Math.round(p21ZuanshiPCCrowdSummary['action'].spend / p21ZuanshiPCCrowdSummary['action'].order) : 0.0;
                    }

                    var p22ZuanshiPCDMPInterestSummary = {};
                    for (var i in pcRpt.zuanshi.targets) {
                        var target = pcRpt.zuanshi.targets[i];
                        if (target.campaignName.indexOf('兴') > -1) {
                            var tName = target.targetName.replace(/.+?:(.+?)/, '$1');
                            if ( ! p22ZuanshiPCDMPInterestSummary[tName]) {
                                p22ZuanshiPCDMPInterestSummary[tName] = {
                                    impression: 0,
                                    click: 0,
                                    ctr: 0,
                                    spend: 0,
                                    cpc: 0,
                                    order: 0,
                                    sale: 0,
                                    cart: 0,
                                    fav: 0,
                                    roi: 0,
                                    cvr: 0,
                                    cpu: 0
                                };
                            }
                            p22ZuanshiPCDMPInterestSummary[tName].impression += parseInt(target.adPv);
                            p22ZuanshiPCDMPInterestSummary[tName].click += parseInt(target.click);
                            p22ZuanshiPCDMPInterestSummary[tName].spend += parseFloat(target.charge);
                            p22ZuanshiPCDMPInterestSummary[tName].order += parseInt(target.alipayInShopNum);
                            p22ZuanshiPCDMPInterestSummary[tName].sale += parseFloat(target.alipayInshopAmt);
                            p22ZuanshiPCDMPInterestSummary[tName].cart += parseInt(target.cartNum);
                            p22ZuanshiPCDMPInterestSummary[tName].fav += parseInt(target.inshopItemColNum);
                        }
                    }
                    
                    for (var i in p22ZuanshiPCDMPInterestSummary) {
                        p22ZuanshiPCDMPInterestSummary[i].cpc = p22ZuanshiPCDMPInterestSummary[i].click > 0 ? p22ZuanshiPCDMPInterestSummary[i].spend / p22ZuanshiPCDMPInterestSummary[i].click : 0;
                        p22ZuanshiPCDMPInterestSummary[i].ctr = p22ZuanshiPCDMPInterestSummary[i].impression > 0 ? p22ZuanshiPCDMPInterestSummary[i].click / p22ZuanshiPCDMPInterestSummary[i].impression * 100 : 0;
                        p22ZuanshiPCDMPInterestSummary[i].roi = p22ZuanshiPCDMPInterestSummary[i].spend > 0 ? p22ZuanshiPCDMPInterestSummary[i].sale / p22ZuanshiPCDMPInterestSummary[i].spend : 0;
                        p22ZuanshiPCDMPInterestSummary[i].cvr = p22ZuanshiPCDMPInterestSummary[i].click > 0 ? (p22ZuanshiPCDMPInterestSummary[i].order / p22ZuanshiPCDMPInterestSummary[i].click) * 100 : 0.0;
                        p22ZuanshiPCDMPInterestSummary[i].cpu = p22ZuanshiPCDMPInterestSummary[i].order > 0 ? Math.round(p22ZuanshiPCDMPInterestSummary[i].spend / p22ZuanshiPCDMPInterestSummary[i].order) : 0.0;
                    }
                %>
                <div id="pageHeader-20">
                    <h3>PC Diamond Display review</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li contenteditable="true">Key findings : xxxxxx。</li>
                </ul>
                <div>
                    <table>
                        <tr class="title">
                            <th>DD-PC人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <td>兴趣</td>  
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].impression %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].click %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].ctr %></span>%</td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].spend %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].cpc %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].order %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].sale %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].cart %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].fav %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].roi %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].cvr %></span>%</td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['interest'].cpu %></span></td> 
                        </tr>
                        <tr>
                            <td>行动意向</td>  
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].impression %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].click %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].ctr %></span>%</td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].spend %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].cpc %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].order %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].sale %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].cart %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].fav %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].roi %></span></td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].cvr %></span>%</td> 
                            <td><span class="number"><%= p21ZuanshiPCCrowdSummary['action'].cpu %></span></td> 
                        </tr>
                        <tr class="total">
                            <td>PC</td>  
                            <td><span class="number"><%= p13ZuanshiPCSummary.impression %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.click %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.ctr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.spend %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cpc %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.order %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.sale %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cart %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.fav %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.roi %></span></td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cvr %></span>%</td> 
                            <td><span class="number"><%= p13ZuanshiPCSummary.cpu %></span></td> 
                        </tr>
                    </table>
                    <br />
                    <table class="small">
                        <tr class="title">
                            <th>DD-PC兴趣人群</th>
                            <th>Impression</th>
                            <th>Click</th>
                            <th>CTR</th>
                            <th>Spend</th>
                            <th>CPC</th>
                            <th>Order</th>
                            <th>Sale</th>
                            <th>Cart</th>
                            <th>Fav</th>
                            <th>ROI</th>
                            <th>CVR</th>
                            <th>CPU</th>
                        </tr>
                        <tr>
                            <% for (var i in p22ZuanshiPCDMPInterestSummary) { %>
                            <tr>
                                <td><%= i %></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].impression %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].click %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].ctr %></span>%</td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].spend %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].cpc %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].order %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].sale %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].cart %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].fav %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].roi %></span></td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].cvr %></span>%</td> 
                                <td><span class="number"><%= p22ZuanshiPCDMPInterestSummary[i].cpu %></span></td> 
                            </tr>
                            <% } %>
                        </tr>
                    </table>
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-21">
                    <h3>Diamond Display Creative review & A/B Testing</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li></li>
                </ul>
                <div>
                    
                </div>
            </div>

            <div class="page">
                <div id="pageHeader-22">
                    <h3>Action Plan Summary</h3>
                    <span class="logo">Dyson</span>
                </div>
                <ul>
                    <li></li>
                </ul>
                <div>
                    直通车：
   1、品牌保护初见成效，各关键词基本都已站住有利位置。
   2、增加EC系列品类词，同时根据数据反馈及时优化。
   3、调整EC和FC花费比例，增加调整活动日常预算比例
钻展：
   1、钻展EC系列预算占比较大，但EC数据反馈较差，本周EC调整人群投放。虽然但EC反馈较差，但后期对于EC的销售有一定促进；
   2、EC净化器开始分地域分素材投放。
                </div>
            </div>

            <script type="text/javascript" src="http://cdn.bootcss.com/jquery/1.12.4/jquery.min.js"></script>
            <script type="text/javascript" src="../echarts.min.js"></script>
            <script type="text/javascript" src="../dom-to-image.min.js"></script>
            <script type="text/javascript">
            $(document).ready(function() {
                $('.number').each(function(i, v) {
                    var value = parseFloat($(v).text());
                    value = Math.round(value * 100) / 100;
                    $(v).text(thousandBitSeparator(value));
                });
                /*
                var p2SubwayCostChart = echarts.init(document.getElementById('p2_subway_cost_chart'));
                var p2SubwayCostChartOption = {
                    title: {
                        text: '直通车花费',
                        x:'center'
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: '{a} <br/>{b} : {c} ({d}%)'
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'right',
                        data: ['EC','FC','PC']
                    },
                    series: [{
                        name: '直通车花费',
                        type: 'pie',
                        radius: '80%',
                        center: ['50%', '60%'],
                        data:[
                            {value: $('#p2_subway_cost_chart').attr('data-ec'), name: 'EC'},
                            {value: $('#p2_subway_cost_chart').attr('data-fc'), name: 'FC'},
                            {value: $('#p2_subway_cost_chart').attr('data-pc'), name: 'PC'},
                        ],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: true,
                                    position:'inside',
                                    formatter: '{b} : {d}%'
                                }
                            },
                            labelLine: {
                                show: true
                            },
                            emphasis: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }]
                };
                p2SubwayCostChart.setOption(p2SubwayCostChartOption);

                var p2ZuanshiCostChart = echarts.init(document.getElementById('p2_zuanshi_cost_chart'));
                var p2ZuanshiCostChartOption = {
                    title: {
                        text: '钻展花费',
                        x:'center'
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: '{a} <br/>{b} : {c} ({d}%)'
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'right',
                        data: ['EC','FC','PC']
                    },
                    series: [{
                        name: '钻展花费',
                        type: 'pie',
                        radius: '80%',
                        center: ['50%', '60%'],
                        data:[
                            {value: $('#p2_zuanshi_cost_chart').attr('data-ec'), name: 'EC'},
                            {value: $('#p2_zuanshi_cost_chart').attr('data-fc'), name: 'FC'},
                            {value: $('#p2_zuanshi_cost_chart').attr('data-pc'), name: 'PC'},
                        ],
                        itemStyle: {
                            normal: {
                                label: {
                                    show: true,
                                    position:'inside',
                                    formatter: '{b} : {d}%'
                                }
                            },
                            labelLine: {
                                show: true
                            },
                            emphasis: {
                                shadowBlur: 10,
                                shadowOffsetX: 0,
                                shadowColor: 'rgba(0, 0, 0, 0.5)'
                            }
                        }
                    }]
                };
                p2ZuanshiCostChart.setOption(p2ZuanshiCostChartOption);

                setTimeout(function() {
                    var node = document.getElementById('p2_subway_cost_chart');
                    domtoimage.toJpeg(node, {bgcolor: '#FFFFFF'})
                        .then(function (dataUrl) {
                            var img = new Image();
                            img.src = dataUrl;
                            img.id = 'p2_subway_cost_chart';
                            $('#p2_subway_cost_chart').html(img);
                        });

                    var node = document.getElementById('p2_zuanshi_cost_chart');
                    domtoimage.toJpeg(node, {bgcolor: '#FFFFFF'})
                        .then(function (dataUrl) {
                            var img = new Image();
                            img.src = dataUrl;
                            img.id = 'p2_zuanshi_cost_chart';
                            $('#p2_zuanshi_cost_chart').html(img);
                        });
                }, 1000);
                */
            });

            function thousandBitSeparator(num) {
                var re = /(\d{1,3})(?=(\d{3})+(?:$|\.))/g;
                return num.toString().replace(re, '$1,');
            }
            </script>
        </body>
    </html>
